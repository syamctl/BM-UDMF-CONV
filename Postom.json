[
{
    "ruleID":"2",
    "ruleType":"extractCON",
    "dataFrameID":"CDS_BMCONV_ACCOUNT",
    "persist":"Y",
    "ruleStatus":"on",
    "ruleDescription":"Identify accounts ready for BM Conversion",
    "ruleCategory":"EG",
    "sourceType":"jdbc",
	"fetchSize":"10000",
	"numberOfPartitions":"16",
	"debugInfo":"PARTITIONS",
    "connectionName":"udmfcon_bppconnection2",
    "ruleText":"SELECT /*+ DRIVING_SITE(sf) */ /*+ PARALLEL(8) */ distinct TRIM(sf.PRODUCT_ID) BLG_ACCT_TEL_NO, sf.ban, trim(sf.ban) AS bann FROM LC_BM_CON_STATUS_10_C lc INNER JOIN cuappc.service_feature@enspetlink sf ON sf.ban = lc.ban WHERE dq_status = 'N' AND sf.ftr_expiration_date IS NULL AND sf.product_type = 'IL'"
  },
  {
    "ruleID":"1",
    "ruleType":"executeSQLQuery",
    "dataFrameID":"BMCONV_ACCOUNT",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"To Get the BMCONV_ACCOUNT",
    "ruleCategory":"TG",
    //"debugInfo":"rows",
    "ruleText":"select BLG_ACCT_TEL_NO from CDS_BMCONV_ACCOUNT"
  },
   {
    "ruleID":"4",
    "ruleType":"extractCON",
    "dataFrameID":"BMCONV_FUTURECODE1",
    "persist":"Y",
    "ruleStatus":"on",
    "ruleDescription":"Identify accounts Feature Codes and Descriptions",
    "ruleCategory":"EG",
    "sourceType":"jdbc",
	"fetchSize":"10000",
	"numberOfPartitions":"16",
	"debugInfo":"PARTITIONS",
    "connectionName":"udmfcon_bppconnection2",
    "ruleText":"SELECT /*+ DRIVING_SITE(SF) */ /*+ PARALLEL(8) */ distinct SF.BAN , SF.PRODUCT_ID,SF.PRODUCT_TYPE,trim(SF.FEATURE_CODE) FEATURE_CODE,F.FEATURE_DESC,F.SUB_CONTAINER_TYPE,trim(SF.PRICE_PLAN) PRICE_PLAN,TRIM(CB.BUNDLE_CODE) BUNDLE_CODE,SF.BUNDLE_SEQ,CB.BUNDLE_DESC,SF.PP_EFFECTIVE_DATE,SF.FTR_EFFECTIVE_DATE,SF.FTR_EXPIRATION_DATE,trim(sf.PRODUCT_ID) as BLG_ACCT_TEL_NO , trim(BD.CONTRACT_TERM) CONTRACT_TERM FROM LC_BM_CON_STATUS_10_C lc inner join CUAPPC.SERVICE_FEATURE@enspetlink SF on SF.BAN =Lc.ban inner join CUAPPC.FEATURE@enspetlink F on F.FEATURE_CODE=SF.FEATURE_CODE inner join CUAPPC.PRICE_PLAN@enspetlink PP on PP.PRICE_PLAN=SF.PRICE_PLAN  left outer join CUAPPC.CSM_BUNDLE@enspetlink CB on CB.BUNDLE_SEQ=SF.BUNDLE_SEQ left outer join CUAPPC.PP_BUNDLE_DEF@enspetlink BD on trim(BD.BUNDLE_CODE)=trim(CB.BUNDLE_CODE) WHERE LC.DQ_STATUS='N' and PP.EXPIRATION_DATE is null AND SF.FTR_EXPIRATION_DATE IS NULL AND SF.PRODUCT_TYPE in ('WA','IL')"
  },
    {
    "ruleID":"3",
    "ruleType":"executeSQLQuery",
    "dataFrameID":"BMCONV_FUTURECODE",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"To Get the BMCONV_FUTURECODE",
    "ruleCategory":"TG",
//	"debugInfo":"rows",
    "ruleText":"select distinct b.BLG_ACCT_TEL_NO,a.BAN,'FTTN-ETH-V2' AS networkInfrastructureIndCd, a.PRODUCT_ID, a.PRODUCT_TYPE,trim(a.FEATURE_CODE) as FEATURE_CODE ,a.FEATURE_DESC, a.PRICE_PLAN,a.BUNDLE_CODE,a.BUNDLE_SEQ,a.BUNDLE_DESC,a.PP_EFFECTIVE_DATE,a.FTR_EFFECTIVE_DATE,a.FTR_EXPIRATION_DATE,a.CONTRACT_TERM    from BMCONV_FUTURECODE1 a   inner join (select distinct ban,BLG_ACCT_TEL_NO from BMCONV_FUTURECODE1 where PRODUCT_TYPE='IL') b  on b.ban=a.ban   where PRODUCT_TYPE='WA'"
  },
  {
    "ruleID":"44",
    "ruleType":"extractCON",
    "dataFrameID":"ref_sub_market",
    "persist":"Y",
    "ruleStatus":"on",
    "ruleDescription":"Extract ref_sub_market",
    "ruleCategory":"EG",
    "sourceType":"jdbc",
	"fetchSize":"10000",
	"numberOfPartitions":"16",
	"debugInfo":"PARTITIONS",
    "ruleText":"bmconv_poc.ref_sub_market",
    "connectionName":"udmfcon_mysqlconnection1"
  },
  {
    "ruleID":"5",
    "ruleType":"extractCON",
    "dataFrameID":"BMCONV_ACCOUNT_FIDS1",
    "persist":"Y",
    "ruleStatus":"on",
    "ruleDescription":"Identify accounts Feature Codes and Descriptions",
    "ruleCategory":"EG",
    "sourceType":"jdbc",
    "fetchSize":"10000",
	"numberOfPartitions":"16",
	"debugInfo":"PARTITIONS",
    "ruleText":"select /*+ PARALLEL(8) */ distinct trim(AN.PRODUCT_ID) BLG_ACCT_TEL_NO ,AN.PRODUCT_TYPE, AN.BAN, ND.FIRST_NAME||'@abc.com' as emailAddress,'4796671041' as contactNumber, FIRST_NAME,LAST_BUSINESS_NAME as LAST_NAME FROM LC_BM_CON_STATUS_10_C LC inner join CUAPPC.ADDRESS_NAME_LINK@enspetlink AN on AN.BAN=LC.BAN inner join CUAPPC.NAME_DATA@enspetlink ND on ND.NAME_ID=AN.NAME_ID inner join CUAPPC.PRODUCT@enspetlink P on P.PRODUCT_ID=AN.PRODUCT_ID AND P.PRODUCT_TYPE = AN.PRODUCT_TYPE and P.CUSTOMER_ID=AN.BAN Where P.PROD_STATUS = 'A' and AN.PRODUCT_TYPE = 'IL' and an.link_type = 'U'and ND.FIRST_NAME is not null  and AN.EXPIRATION_DATE IS NULL and DQ_STATUS='N'",
    "connectionName":"udmfcon_bppconnection2"
  },
   {
    "ruleID":"7",
    "ruleType":"extractCON",
    "dataFrameID":"BMCONV_BILL_CYCLE",
    "persist":"Y",
    "ruleStatus":"on",
    "ruleDescription":"Identify accounts for bill cycle",
    "ruleCategory":"EG",
    "sourceType":"jdbc",
	"fetchSize":"10000",
	"numberOfPartitions":"16",
	"debugInfo":"PARTITIONS",
	"connectionName":"udmfcon_bppconnection2",
    "ruleText":"select /*+ DRIVING_SITE(SF) */ /*+ PARALLEL(8) */ distinct BA.BAN, bill_cycle as billcycle , trim(SF.PRODUCT_ID) as BLG_ACCT_TEL_NO from LC_BM_CON_STATUS_10_C lc inner join cuappc.billing_account@enspetlink BA on ba.ban=lc.ban inner join CUAPPC.SERVICE_FEATURE@enspetlink SF on SF.BAN=BA.ban where BA.BAN_STATUS = 'O' and BA.customer_type ='I' AND SF.FTR_EXPIRATION_DATE IS NULL and SF.PRODUCT_TYPE ='IL' and DQ_STATUS='N' "
  },
     {
    "ruleID":"11",
    "ruleType":"extractCON",
    "dataFrameID":"ref_usoc_rfsid_bmprod",
    "persist":"Y",
    "ruleStatus":"on",
    "ruleDescription":"Extract ref_usoc_rfsid_bmprod",
    "ruleCategory":"EG",
    "sourceType":"jdbc",
	"fetchSize":"10000",
	"numberOfPartitions":"16",
	"debugInfo":"PARTITIONS",
    "ruleText":"bmconv_poc.ref_usoc_rfsid_bmprod",
    "connectionName":"udmfcon_mysqlconnection1"
  },
  {
    "ruleID":"12",
    "ruleType":"extractCON",
    "dataFrameID":"ref_bm_offer_data",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Extract ref_bm_offer_data",
    "ruleCategory":"EG",
    "sourceType":"jdbc",
	"fetchSize":"10000",
	"numberOfPartitions":"16",
	"debugInfo":"PARTITIONS",
    "ruleText":"bmconv_poc.ref_bm_offer_data",
    "connectionName":"udmfcon_mysqlconnection1"
  },
  {
    "ruleID":"1200002",
    "ruleType":"executeSQLQuery",
    "dataFrameID":"ref_bm_offer_data",
    "persist":"Y",
    "ruleStatus":"on",
    "ruleDescription":"To Get the BMCONV_FUTURECODE_CONT",
    "ruleCategory":"TG",
 // "debugInfo":"rows",
//	"stopExecution":"Y",
    "ruleText":"select b.* ,A.BAN from ref_bm_offer_data b inner join (Select distinct A.BAN,B.BM_PRODUCT_NAME,(CASE WHEN UPPER(B.BM_PRODUCT_NAME)='MODEM' THEN NULL ELSE CONTRACT_TERM END)CONTRACT_TERM,(CASE WHEN UPPER(B.BM_PRODUCT_NAME)='MODEM' THEN NULL ELSE BUNDLE_CODE END ) BUNDLE_CODE from BMCONV_FUTURECODE a ,ref_usoc_rfsid_bmprod b where trim(a.FEATURE_CODE)=trim(b.USOC_VAL)) a on   trim(a.BM_PRODUCT_NAME)=trim(b.OFFER_COMPONENT) and NVL(a.CONTRACT_TERM,0)=NVL(b.CONTRACT_TERM,0) and nvl(trim(a.BUNDLE_CODE),'0')=nvl(trim(b.BUNDLE_CODE),'0')"
  },
   {
    "ruleID":"14",
    "ruleType":"extractCON",
    "dataFrameID":"ref_catalog_data",
    "persist":"Y",
    "ruleStatus":"on",
    "ruleDescription":"Extract ref_bm_prod_data",
    "ruleCategory":"EG",
    "sourceType":"jdbc",
 	"fetchSize":"10000",
	"numberOfPartitions":"16",
	"debugInfo":"PARTITIONS",
    "ruleText":"bmconv_poc.ref_catalog_data",
    "connectionName":"udmfcon_mysqlconnection1"
  },
  {
    "ruleID":"15",
    "ruleType":"extractCON",
    "dataFrameID":"ref_cart_prod_attr",
    "persist":"Y",
    "ruleStatus":"on",
    "ruleDescription":"Extract ref_cart_prod_attr",
    "ruleCategory":"EG",
    "sourceType":"jdbc",
	"fetchSize":"10000",
	"numberOfPartitions":"16",
	"debugInfo":"PARTITIONS",
    "ruleText":"bmconv_poc.ref_cart_prod_attr",
    "connectionName":"udmfcon_mysqlconnection1"
  },
  {
    "ruleID":"16",
    "ruleType":"extractCON",
    "dataFrameID":"ref_sr_prod_attr",
    "persist":"Y",
    "ruleStatus":"on",
    "ruleDescription":"Extract ref_sr_prod_attr",
    "ruleCategory":"EG",
    "sourceType":"jdbc",
	"fetchSize":"10000",
	"numberOfPartitions":"16",
	"debugInfo":"PARTITIONS",
    "ruleText":"bmconv_poc.ref_sr_prod_attr",
    "connectionName":"udmfcon_mysqlconnection1"
  },
    {
    "ruleID":"17",
    "ruleType":"extractCON",
    "dataFrameID":"ENS_PRICE",
    "persist":"Y",
    "ruleStatus":"on",
    "ruleDescription":"To Get Product Prices from Source DB",
    "ruleCategory":"EG",
    "sourceType":"jdbc",
 	"fetchSize":"10000",
	"numberOfPartitions":"16",
	"debugInfo":"PARTITIONS",
    "connectionName":"udmfcon_bppconnection2",
    "ruleText":"select /*+ DRIVING_SITE(sf) */ /*+ PARALLEL(8) */ DISTINCT sf.price_plan, sf.ban,rC.feature_code ,f.feature_desc,rc.RC_BASE_AMOUNT  RC, f.container_type, f.sub_container_type ,f.ESN_pricetype priceType,f.esn_pricedescription priceDescription from cuappc.service_feature@enspetlink sf inner join LC_BM_CON_STATUS_10_C lc on lc.ban=sf.ban inner join feature_code_price_details f on f.feature_code =sf.feature_code inner join cuappc.product@enspetlink p on p.customer_id =sf.ban and p.product_id = sf.product_id inner join cuappc.price_plan@enspetlink pp on pp.price_plan=sf.price_plan inner join curefss1.rtf_rc_info@enspetlink rc on rc.price_plan= sf.price_plan AND rc.feature_code = sf.feature_code AND rc.sub_market_code = p.sub_market_code inner join cuappc.billing_account@enspetlink ba on ba.ban= sf.ban Where ba.ban_status = 'O' AND ba.customer_type = 'I' and rc.expiration_date IS NULL AND sf.product_type ='WA' and sf.ftr_expiration_date IS NULL and f.SUB_CONTAINER_TYPE not in ('VAS','EQP') and PP.EXPIRATION_DATE is null and f.FEATURE_CATEORY=0 and lc.dq_status='N'"
  }, 
   {
    "ruleID":"1701",
    "ruleType":"extractCON",
    "dataFrameID":"ENS_PRICE_MODEM",
    "persist":"Y",
    "ruleStatus":"on",
    "ruleDescription":"To Get Product Prices from Source DB",
    "ruleCategory":"EG",
    "sourceType":"jdbc",
 	"fetchSize":"10000",
	"numberOfPartitions":"16",
//	"debugInfo":"rows",
    "connectionName":"udmfcon_bppconnection2",
    "ruleText":"Select /*+ parallel(16) */ * from ( SELECT a.price_plan, a.ban, a.feature_code, a.feature_desc,SUM(rc_base_amount) OVER(PARTITION BY price_plan, ban, container_type) rc,a.container_type,a.sub_container_type, a.pricetype,CASE WHEN pricetype = 'PRICE' THEN 'MRC/OTC' ELSE feature_desc END pricedescription FROM ( SELECT /*+ DRIVING_SITE(sf) */ /*+ parallel(16) */ DISTINCT sf.price_plan,sf.ban,rc.feature_code,rc_base_amount,f.feature_desc,f.container_type,f.sub_container_type,f.esn_modem_pricetype, (CASE WHEN ( LISTAGG(f.esn_modem_pricetype, ',') WITHIN GROUP( ORDER BY sf.ban ) OVER( PARTITION BY sf.ban ) ) = 'BILLING,PRICE' THEN f.esn_modem_pricetype WHEN ( LISTAGG(f.esn_modem_pricetype, ',') WITHIN GROUP( ORDER BY sf.ban ) OVER( PARTITION BY sf.ban ) ) = 'PRICE,BILLING' THEN f.esn_modem_pricetype ELSE 'PRICE' END ) pricetype FROM cuappc.service_feature@enspetlink   sf INNER JOIN lc_bm_con_status_10_c lc ON lc.ban = sf.ban INNER JOIN feature_code_price_details f ON f.feature_code = sf.feature_code INNER JOIN cuappc.product@enspetlink p ON p.customer_id = sf.ban AND p.product_id = sf.product_id INNER JOIN cuappc.price_plan@enspetlink pp ON pp.price_plan = sf.price_plan INNER JOIN curefss1.rtf_rc_info@enspetlink rc ON rc.price_plan = sf.price_plan AND rc.feature_code = sf.feature_code AND rc.sub_market_code = p.sub_market_code INNER JOIN cuappc.billing_account@enspetlink   ba ON ba.ban = sf.ban WHERE ba.ban_status = 'O' AND ba.customer_type = 'I' AND rc.expiration_date IS NULL AND sf.product_type = 'WA' AND sf.ftr_expiration_date IS NULL AND f.sub_container_type IN ( 'EQP','NA' ) AND pp.expiration_date IS NULL AND f.feature_cateory > 0 AND lc.dq_status = 'N' ) a) WHERE feature_code != 'J00CS' "
  }, 
     {
    "ruleID":"1702",
    "ruleType":"extractCON",
    "dataFrameID":"ENS_PRICE_EASE",
    "persist":"Y",
    "ruleStatus":"on",
    "ruleDescription":"To Get Product Prices from Source DB",
    "ruleCategory":"EG",
    "sourceType":"jdbc",
 	"fetchSize":"10000",
	"numberOfPartitions":"16",
	"debugInfo":"PARTITIONS",
    "connectionName":"udmfcon_bppconnection2",
    "ruleText":"SELECT /*+ DRIVING_SITE(sf) */ /*+ PARALLEL(8) */ price_plan, ban, feature_code, feature_desc,cast(( CASE WHEN ( pricetype = 'PRICE' AND rc = 0 ) THEN SUM(rc) OVER( PARTITION BY ban, price_plan ) ELSE rc END ) as decimal(9,2)) rc, container_type, sub_container_type, pricetype, pricedescription FROM ( select /*+ PARALLEL(8) */ DISTINCT sf.price_plan, sf.ban,rC.feature_code ,f.feature_desc, rc.RC_BASE_AMOUNT RC, f.container_type,f.sub_container_type ,f.ESN_EASE_pricetype pricetype,f.esn_ease_pricedescription pricedescription from cuappc.service_feature@enspetlink sf inner join LC_BM_CON_STATUS_10_C lc on lc.ban=sf.ban inner join feature_code_price_details f on f.feature_code =sf.feature_code inner join cuappc.product@enspetlink p on p.customer_id =sf.ban and p.product_id = sf.product_id inner join cuappc.price_plan@enspetlink pp on pp.price_plan=sf.price_plan inner join curefss1.rtf_rc_info@enspetlink rc on rc.price_plan= sf.price_plan AND rc.feature_code = sf.feature_code AND rc.sub_market_code = p.sub_market_code inner join cuappc.billing_account@enspetlink ba on ba.ban= sf.ban Where ba.ban_status = 'O' AND ba.customer_type = 'I' and rc.expiration_date IS NULL AND sf.product_type ='WA' and sf.ftr_expiration_date IS NULL and f.SUB_CONTAINER_TYPE ='VAS' and PP.EXPIRATION_DATE is null and lc.dq_status='N')"
  }, 
  {
    "ruleID":"17000",
    "ruleType":"extractCON",
    "dataFrameID":"DISCOUNT_QUERY_EXT",
    "persist":"Y",
    "ruleStatus":"on",
    "ruleDescription":"To Get the Discount related Details",
    "ruleCategory":"EG",
    "sourceType":"jdbc",
 	"fetchSize":"10000",
	"numberOfPartitions":"16",
	"debugInfo":"PARTITIONS",
    "connectionName":"udmfcon_bppconnection2",
    "ruleText":"SELECT /*+ PARALLEL(8) */ DISTINCT a.ban , b.discount_desc discountdescription, b.flat_amt discountrate,trim(regexp_instr(b.discount_desc, 'ROUTER|MODEM|LEASE|TECH INSTALL|PURCHASE|NON-EXCLUDABLE RC',1,1,0,'i' )) discount_CATEORY, trim(regexp_instr(b.discount_desc, 'AT EASE',1,1,0,'i' )) discount_CATEORY_EASE FROM LC_BM_CON_STATUS_10_C lc inner join cuappc.ban_discount@enspetlink a on a.ban=lc.ban inner join cuappc.discount_plan@enspetlink b on b.discount_plan_cd=a.discount_code inner join cuappc.billing_account@enspetlink c on c.ban=a.ban WHERE c.ban_status = 'O'  AND c.customer_type = 'I' AND a.product_type IN ('WA') AND a.expiration_date > sysdate and dq_status='N'"
  },
   {
    "ruleID":"18",
    "ruleType":"extractCON",
    "dataFrameID":"ADDRESS_INFO",
    "persist":"Y",
    "ruleStatus":"on",
    "ruleDescription":"Extract address info over a connection",
    "ruleCategory":"EG",
	"fetchSize":"10000",
	"numberOfPartitions":"16",
	"debugInfo":"count",
    "ruleText":"SELECT /*+ PARALLEL(8) */ DISTINCT   a.ban ,a.address_id,'false' postaladdressflag, a.streetaddress,a.city,a.stateorprovince ,a.zip,'' unit,'' unitnumber,a.country,NULL streetaddress1, NULL streetnrfirst,NULL streetnrfirstsuffix,NULL streetnrlast,NULL streetnrlastsuffix,NULL streetname, NULL streettype,NULL locality,NULL city1,NULL stateorprovince1, NULL postcode,NULL postcodesuffix,NULL inrangeaddress, to_char(a.serviceAddress) serviceAddress FROM restapi_address_info_1 a, LC_BM_CON_STATUS_10_C  lc WHERE  a.ban = lc.ban and lc.dq_status ='N'",
    "connectionName":"udmfcon_bppconnection2",
    "sourceType":"jdbc"
  },
   {
    "ruleID":"109",
    "ruleType":"joinTables",
    "dataFrameID":"CDS_BMCONV_ACCOUNT_CASE1",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Join Accounts table with ADDRESS_INFO",
    "ruleText":"CDS_BMCONV_ACCOUNT,bann,ADDRESS_INFO,BAN",
    "ruleCategory":"TG",
    "joinType":"left",
    //"debugInfo":"rows",
    "renameKeys":"Y"
  },
   {
    "ruleID":"111",
    "ruleType":"generateSequence",
    "dataFrameID":"CDS_BMCONV_ACCOUNT_CASE1",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Add a column _id using a seqnece generator",
    "sourceInfo":"CDS_BMCONV_ACCOUNT_CASE1,_id",
    "ruleCategory":"TG",
    "sequenceInfo":"omcollectionSeq1,1,16",
    "concatWith":"ORN-7"
  },
   {
    "ruleID":"160",
    "ruleType":"executeSQLQuery",
    "dataFrameID":"CDS_BMCONV_ACCOUNT_CASE2",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"To Get the _id",
    "ruleCategory":"TG",
 //	"debugInfo":"count",
    "ruleText":"select a.*,a._id as orderReferenceNumber, 'com.ctl.bm.service.order_management_business_service.model.customer_order.CustomerOrder' _class , regexp_replace(date_format(to_utc_timestamp(current_timestamp(),'PST'),'yyyy-MM-dd HH:mm:ss.SSS'),' ','T')||'Z' creationDate ,regexp_replace(date_format(to_utc_timestamp(current_timestamp(),'PST'),'yyyy-MM-dd HH:mm:ss.SSS'),' ','T')||'Z' updationDate,'updateCustomerOrder' methodName,'OrderManagementSearchRepository' _className , cast (row_number() over(order by 1)+1000374520  as String) as customerOrderNumber , 'COMPLETED' customerOrderStatus , 'NEWINSTALL' customerOrderType , 'Regular' customerSegment , 'INDIVIDUAL' customerType , concat(regexp_replace(to_utc_timestamp(current_timestamp(),'PST'),' ','T'),'Z') orderDate ,'1' orderVersion ,'ESHOP-Customer Care' salesChannel , 'CONVERSION_ENS_POSTPAID' sourceSystem   from CDS_BMCONV_ACCOUNT_CASE1 a "
  },
   {
    "ruleID":"123",
    "ruleType":"addColumns",
    "dataFrameID":"CDS_BMCONV_ACCOUNT_CASE2",
    "persist":"N",
    "ruleStatus":"on",
    "ruleCategory":"TG",
//  "debugInfo":"rows",
    "ruleDescription":"Add a new column pointOfNoReturn with value true",
    "ruleText":"CDS_BMCONV_ACCOUNT_CASE2,pointOfNoReturn,true"
  },
  {
    "ruleID":"126",
    "ruleType":"getStructColumn",
    "dataFrameID":"CDS_BMCONV_ACCOUNT_CASE2",
    "persist":"N",
    "ruleStatus":"on",
    "ruleCategory":"TG",
    //"debugInfo":"rows",
    "ruleDescription":"Prepare a structure column orderReference using necessary columns added",
    "ruleText":"CDS_BMCONV_ACCOUNT_CASE2,orderReference,customerOrderNumber,customerOrderStatus,customerOrderType,customerSegment,customerType,orderDate,orderReferenceNumber,orderVersion,pointOfNoReturn,salesChannel,sourceSystem"
  },
  {
"ruleID":"10001",
"ruleType":"str2Struct",
"dataFrameID":"CDS_BMCONV_ACCOUNT_CASE2",
"persist":"Y",
"ruleStatus":"on",
"ruleCategory":"TG",
//"debugInfo":"rows",
"ruleText":"CDS_BMCONV_ACCOUNT_CASE2,serviceAddress,serviceAddress",
"schemaToUse":"{\"type\":\"struct\",\"fields\":[{\"name\":\"addressId\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"streetAddress\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"streetNrFirst\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"streetNrFirstSuffix\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"streetNrLast\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"streetNrLastSuffix\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"streetName\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"streetNamePrefix\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"streetType\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"locality\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"city\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"stateOrProvince\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"postCode\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"postCodeSuffix\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"sourceId\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"source\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"geoAddressId\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"subAddress\",\"type\":{\"type\":\"struct\",\"fields\":[{\"name\":\"combinedDesignator\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"elements\",\"type\":{\"type\":\"array\",\"elementType\":{\"type\":\"struct\",\"fields\":[{\"name\":\"designator\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"value\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}}]},\"containsNull\":true},\"nullable\":true,\"metadata\":{}},{\"name\":\"geoSubAddressId\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"source\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"sourceId\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}}]},\"nullable\":true,\"metadata\":{}},{\"name\":\"country\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"geoPoint\",\"type\":{\"type\":\"array\",\"elementType\":{\"type\":\"struct\",\"fields\":[{\"name\":\"accuracy\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"coordinateLevel\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"latitude\",\"type\":\"double\",\"nullable\":true,\"metadata\":{}},{\"name\":\"longitude\",\"type\":\"double\",\"nullable\":true,\"metadata\":{}},{\"name\":\"source\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}}]},\"containsNull\":true},\"nullable\":true,\"metadata\":{}},{\"name\":\"locationAttributes\",\"type\":{\"type\":\"struct\",\"fields\":[{\"name\":\"cala\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"isMdu\",\"type\":\"boolean\",\"nullable\":true,\"metadata\":{}},{\"name\":\"legacyProvider\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"martensClli6\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"npa\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"nxx\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"rateCenter\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"tarCode\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"tta\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"wirecenter\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}}]},\"nullable\":true,\"metadata\":{}},{\"name\":\"timeZone\",\"type\":{\"type\":\"struct\",\"fields\":[{\"name\":\"ianaName\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"isDaylightSavingsTime\",\"type\":\"boolean\",\"nullable\":true,\"metadata\":{}},{\"name\":\"name\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"offset\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}}]},\"nullable\":true,\"metadata\":{}},{\"name\":\"npaNxxList\",\"type\":{\"type\":\"array\",\"elementType\":{\"type\":\"struct\",\"fields\":[{\"name\":\"npa\",\"type\":{\"type\":\"struct\",\"fields\":[{\"name\":\"code\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}}]},\"nullable\":true,\"metadata\":{}},{\"name\":\"nxx\",\"type\":{\"type\":\"struct\",\"fields\":[{\"name\":\"code\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}}]},\"nullable\":true,\"metadata\":{}}]},\"containsNull\":true},\"nullable\":true,\"metadata\":{}}]}",
"ruleDescription":"Get the Service address as Struct Column"
},
   {
    "ruleID":"1300",
    "ruleType":"executeSQLQuery",
    "dataFrameID":"BMCONV_ACCOUNT_STG_AOGRGNGIOA_1",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"To Get the martensClli6 value",
    "ruleCategory":"TG",
    //"debugInfo":"rows",
    "ruleText":"select distinct BAN,BLG_ACCT_TEL_NO,ServiceAddress.locationAttributes.martensClli6 as orderAttributeValue ,'martensClli6' as orderAttributeName  from CDS_BMCONV_ACCOUNT_CASE2"
  },
  {
    "ruleID":"130",
    "ruleType":"executeSQLQuery",
    "dataFrameID":"HSI_Product_Attributes_AL",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"To Get the HSI allowMACD attribute name and value",
    "ruleCategory":"TG",
 //   "filter":"attributeName = 'allowMACD'",
    //"debugInfo":"rows",
    "ruleText":"select distinct tech.BAN,tech.BLG_ACCT_TEL_NO, BM_PRODUCT_ID, ATTRIBUTE_NAME attributeName,ATTRIBUTE_NAME attrgp , case ATTRIBUTE_NAME when 'Derived DownSpeed' then Derived_DownSpeed when 'Derived Upspeed' then Derived_Upspeed when 'ProductActivationDate' then  concat(regexp_replace(to_utc_timestamp(current_timestamp(),'PST'),' ','T'),'Z') when 'allowMACD' then 'Y' when 'serviceIdentifier' then trim(tech.PRODUCT_ID) else 'else' end attributeValue, case ATTRIBUTE_NAME when 'allowMACD' then  'NA'  when 'serviceIdentifier'  then 'NA' when 'Derived DownSpeed' then downspeed_uom when 'ProductActivationDate' then 'NA' when 'Derived Upspeed' then upspeed_uom   else 'else' end uom from ref_usoc_rfsid_bmprod urb inner join BMCONV_FUTURECODE tech on urb.USOC_VAL = tech.FEATURE_CODE inner join ref_cart_prod_attr cpa on cpa.CART_PROD_ATTR_LIST_ID =urb.CART_PROD_ATTR_LIST_ID where upper(urb.BM_PRODUCT_NAME) not in ('MODEM' ,'CENTURYLINK @ EASE') and ATTRIBUTE_NAME  in ('allowMACD','serviceIdentifier','Derived DownSpeed','ProductActivationDate','Derived Upspeed')"
  },
    {
    "ruleID":"132",
    "ruleType":"getStructColumn",
    "dataFrameID":"HSI_Product_Attributes_AL",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a structure for HSI allowMACD - compositeAttributes",
    "ruleCategory":"TG",
	//"debugInfo":"rows",
    "ruleText":"HSI_Product_Attributes_AL,compositeAttributes,attributeName,attributeValue,uom"
  },
    {
    "ruleID":"133",
    "ruleType":"getFrozenList",
    "dataFrameID":"HSI_Product_Attributes_AL",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a Array Structure for HSI allowMACD",
    "ruleCategory":"TG",
	//"debugInfo":"rows",
    "ruleText":"HSI_Product_Attributes_AL,compositeAttribute,compositeAttributes",
    "keyColumns":"BAN,attrgp"
  },
  {
    "ruleID":"1330000",
    "ruleType":"dropColumns",
    "dataFrameID":"HSI_Product_Attributes_AL",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Removing  attrgp",
    "ruleCategory":"TG",
	//"debugInfo":"rows",
    "ruleText":"HSI_Product_Attributes_AL,attrgp"
  },
  {
    "ruleID":"134",
    "ruleType":"addColumns",
    "dataFrameID":"HSI_Product_Attributes_AL",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Added new column for HSI allowMACD-isDefault with 0",
    "ruleCategory":"TG",
//	// //  "debugInfo":"rows",
    "ruleText":"HSI_Product_Attributes_AL,isDefault,0"
  },
  {
    "ruleID":"135",
    "ruleType":"addColumns",
    "dataFrameID":"HSI_Product_Attributes_AL",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Added new column for HSI allowMACD-displayOrder with 0",
    "ruleCategory":"TG",
    "ruleText":"HSI_Product_Attributes_AL,displayOrder,0"
  },
  {
    "ruleID":"136",
    "ruleType":"addColumns",
    "dataFrameID":"HSI_Product_Attributes_AL",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Added new column for HSI allowMACD-isPriceable with false",
    "ruleCategory":"TG",
    "ruleText":"HSI_Product_Attributes_AL,isPriceable,false"
  },
    {
    "ruleID":"137",
    "ruleType":"addNullColumn",
    "dataFrameID":"HSI_Product_Attributes_AL",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Added new column for HSI allowMACD-discounts with empty Array",
    "ruleCategory":"TG",
//	"debugInfo":"schema",
    "ruleText":"HSI_Product_Attributes_AL,discounts,array<struct<autoAttachInd: String,discountId: String, discountDescription: String, discountRate: Decimal(9,2), discountMethod: String, discountLevel: String, discountDuration: Decimal(9,2), discountType: String, discountCategory: String,discountMaxAmount: String,discountRule: String,discountMinimumAmount: String,discountIdSequence: Decimal(7,0),discountStartDate: timestamp,discountExpiryDate: timestamp>>"
  },
  {
    "ruleID":"138",
    "ruleType":"addNullColumn",
    "dataFrameID":"HSI_Product_Attributes_AL",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Added new column for HSI allowMACD-prices with empty Array",
    "ruleCategory":"TG",
    "ruleText":"HSI_Product_Attributes_AL,prices,array<struct<priceType: String,frequency: String, currencyCode: String, discountedOtc: Integer, discountedRc: Decimal(9,2), otc: Integer, rc: Decimal(9,2), priceTypeDescription: String, priceKey: String>>"
  },
  {
    "ruleID":"139",
    "ruleType":"getStructColumn",
    "dataFrameID":"HSI_Product_Attributes_AL",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a Structure for HSI Attibutes",
    "ruleCategory":"TG",
	//"debugInfo":"rows",
    "ruleText":"HSI_Product_Attributes_AL,productAttributes,isDefault,displayOrder,isPriceable,prices,discounts,compositeAttribute"
  },
  {
    "ruleID":"170",
    "ruleType":"executeSQLQuery",
    "dataFrameID":"HSI_Product_Attributes_TDU",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"To Get the HSI Technology attribute name and value",
    "ruleCategory":"TG",
 	// "debugInfo":"rows",
    //"filter":"attributeName = 'Technology'",
    "ruleText":"select distinct tech.BAN,tech.BLG_ACCT_TEL_NO, BM_PRODUCT_ID, ATTRIBUTE_NAME attributeName,  case ATTRIBUTE_NAME  when 'Technology' then technology when 'Downspeed' then Downspeed  when 'Upspeed' then Upspeed else 'else' end attributeValue , case  ATTRIBUTE_NAME when 'Technology'   then  cast(null as String) when 'Downspeed' then  'kbps'  when 'Upspeed' then 'kbps' else 'else' end uom from ref_usoc_rfsid_bmprod urb inner join BMCONV_FUTURECODE  tech on urb.USOC_VAL = tech.FEATURE_CODE inner join ref_cart_prod_attr cpa on cpa.CART_PROD_ATTR_LIST_ID = urb.CART_PROD_ATTR_LIST_ID where upper(urb.BM_PRODUCT_NAME) not in ('MODEM' ,'CENTURYLINK @ EASE') and ATTRIBUTE_NAME in ('Technology','Downspeed','Upspeed')"
  },
  {
    "ruleID":"172",
    "ruleType":"getStructColumn",
    "dataFrameID":"HSI_Product_Attributes_TDU",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a structure for HSI Upspeed - compositeAttributes",
    "ruleCategory":"TG",
    //"debugInfo":"rows",
    "ruleText":"HSI_Product_Attributes_TDU,compositeAttribute,attributeName,attributeValue,uom"
  },
  {
    "ruleID":"180",
    "ruleType":"getFrozenList",
    "dataFrameID":"HSI_Product_Attributes_TDU",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a Array Structure for HSI Technology/Downspeed/Upspeed",
    "ruleCategory":"TG",
    //"debugInfo":"rows",
    "ruleText":"HSI_Product_Attributes_TDU,compositeAttribute,compositeAttribute",
    "keyColumns":"BAN"
  },
   {
    "ruleID":"181",
    "ruleType":"addColumns",
    "dataFrameID":"HSI_Product_Attributes_TDU",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Added new column for HSI Technology/Downspeed/Upspeed-isDefault with 0",
    "ruleCategory":"TG",
    "ruleText":"HSI_Product_Attributes_TDU,isDefault,0"
  },
  {
    "ruleID":"182",
    "ruleType":"addColumns",
    "dataFrameID":"HSI_Product_Attributes_TDU",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Added new column for HSI Technology/Downspeed/Upspeed-displayOrder with 0",
    "ruleCategory":"TG",
    "ruleText":"HSI_Product_Attributes_TDU,displayOrder,0"
  },
  {
    "ruleID":"183",
    "ruleType":"addColumns",
    "dataFrameID":"HSI_Product_Attributes_TDU",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Added new column for HSI Technology/Downspeed/Upspeed-isPriceable with true",
    "ruleCategory":"TG",
	//"debugInfo":"rows",
    "ruleText":"HSI_Product_Attributes_TDU,isPriceable,true"
  },
  
  {
    "ruleID":"185",
    "ruleType":"selectColumns",
    "dataFrameID":"stg_account_address",
    "persist":"N",
    "ruleStatus":"on",
    "ruleCategory":"TG",
    "debugInfo":"count",
	"ruleText":"CDS_BMCONV_ACCOUNT_CASE2,BLG_ACCT_TEL_NO,ban,serviceAddress.city,serviceAddress.stateOrProvince,serviceAddress.locationAttributes.wirecenter",
    "ruleDescription":"Select required columns to add stg_account_address"
  },
  
  {
    "ruleID":"189",
    "ruleType":"executeSQLQuery",
    "dataFrameID":"PRICEKEY_DF",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"TO Get the Price_key",
    "ruleCategory":"TG",
//	"debugInfo":"count",
	"ruleText":"select distinct aa.BLG_ACCT_TEL_NO, aa.BAN, BM_PRODUCT_ID, BM_PRODUCT_NAME, CATALOG_SPEC_ID, CATALOG_CODE, PRODUCT_OFFER_ID, OFFER_NAME,   OFFER_CATEGORY,PriceKey_comp , CONCAT(CATALOG_SPEC_ID, '~', CATALOG_CODE, '~', PRODUCT_OFFER_ID, '~',PriceKey_comp) priceKey from stg_account_address aa  inner join ref_catalog_data cd    on cd.state = aa.stateOrProvince and cd.city = aa.city  and cd.WIRE_CENTER = aa.wirecenter inner join (select tech.BAN, BM_PRODUCT_ID, BM_PRODUCT_NAME, RFSID, PRODUCT, PriceKey_comp from ref_usoc_rfsid_bmprod urb    inner join  BMCONV_FUTURECODE tech on urb.USOC_VAL = tech.FEATURE_CODE ) HSI_Products on aa.BAN = HSI_Products.BAN   inner join ref_bm_offer_data bod on bod.OFFER_COMPONENT = HSI_Products.BM_PRODUCT_NAME and bod.ban = HSI_Products.ban "
  },
  {
    "ruleID":"50000",
    "ruleType":"extractCON",
    "dataFrameID":"DISC_FEATURE",
    "persist":"Y",
    "ruleStatus":"on",
    "ruleDescription":"To Get the Feature Data",
    "ruleCategory":"EG",
    "sourceType":"jdbc",
    "fetchSize":"10000",
	"numberOfPartitions":"16",
	"debugInfo":"PARTITIONS",
    "connectionName":"udmfcon_bppconnection2",
    "ruleText":" SELECT /*+ DRIVING_SITE(sf) */ /*+ PARALLEL(8) */ distinct   sf.ban,    trim(sf.feature_code ) feature_code   FROM    cuappc.service_feature@enspetlink sf inner join LC_BM_CON_STATUS_10_C lc   on lc.ban=sf.ban inner join (SELECT DISTINCT    ban   FROM  cuappc.billing_account@enspetlink WHERE  ban_status = 'O'  AND customer_type = 'I') ba On ba.ban=sf.ban   where sf.ftr_expiration_date IS NULL    AND sf.product_type IN ('WA' )  and lc.dq_status = 'N'"
  },
  {
    "ruleID":"50001",
    "ruleType":"executeSQLQuery",
    "dataFrameID":"DISCOUNT_FEATURE_REF",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"TO Get the discount codes ",
    "ruleCategory":"TG",
	//"debugInfo":"rows",
	"ruleText":"select a.BAN,b.BM_PRODUCT_ID,b.BM_PRODUCT_NAME from DISC_FEATURE a inner join ref_usoc_rfsid_bmprod b on a.FEATURE_CODE=b.USOC_VAL"
  },
   {
    "ruleID":"50003",
    "ruleType":"extractCON",
    "dataFrameID":"DISCOUNT_QUERY",
    "persist":"Y",
    "ruleStatus":"on",
    "ruleDescription":"To Get the Discount related Details",
    "ruleCategory":"EG",
    "sourceType":"jdbc",
    "fetchSize":"10000",
	"numberOfPartitions":"16",
	"debugInfo":"PARTITIONS",
    "connectionName":"udmfcon_bppconnection2",
    "ruleText":"select /*+ PARALLEL(8) */ distinct a.ban,'Y' autoAttachInd,trim(b.Discount_PLAN_CD) discountId,b.discount_desc discountDescription,b.FLAT_AMT discountRate ,  b.DISC_QTY_TYPE discountMethod,b.DISCOUNT_PLAN_LEVEL discountLevel,b.DISCOUNT_DURATION discountDuration,b.DISPLAY_TYPE discountType,'RCD' discountCategory,  CAST(b.MAX_DISCOUNT_AMT as Varchar2(100)) discountMaxAmount, cast (b.MIN_AMT as Varchar2(100)) discountMinimumAmount,  b.DISCOUNT_RANKING discountIdSequence,'A' discountRule ,a.EFFECTIVE_DATE discountStartDate,a.EXPIRATION_DATE discountExpiryDate ,trim(regexp_instr(b.discount_desc, 'ROUTER|MODEM|LEASE|TECH INSTALL|PURCHASE|NON-EXCLUDABLE RC',1,1,0,'i' )) dis_cat_mod , trim(regexp_instr(b.discount_desc, 'AT EASE',1,1,0,'i' )) dis_cat_ease  from LC_BM_CON_STATUS_10_C lc inner join cuappc.ban_discount@enspetlink a  on a.ban=lc.ban inner join cuappc.DISCOUNT_PLAN@enspetlink b   on a.DISCOUNT_CODE=b.DISCOUNT_PLAN_CD inner join  cuappc.billing_account@enspetlink c   on c.ban=a.ban where  c.BAN_STATUS = 'O' and c.customer_type = 'I'   and a.Product_type in ('WA') and a.EXPIRATION_DATE > SYSDATE and LC.DQ_STATUS='N'"
  },
  {
    "ruleID":"50004",
    "ruleType":"executeSQLQuery",
    "dataFrameID":"DISCOUNT_HSI_QUERY",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"TO Get the Prod Details",
    "ruleCategory":"TG",
//	"debugInfo":"count",
	"ruleText":"select a.ban,a.autoAttachInd,a.discountId,a.discountDescription,a.discountRate,a.discountMethod,a.discountLevel,a.discountDuration,a.discountType,a.discountCategory, a.discountMaxAmount, a.discountMinimumAmount,a.discountIdSequence,a.discountRule ,a.discountStartDate,a.discountExpiryDate ,b.BM_PRODUCT_ID from DISCOUNT_QUERY a inner  join DISCOUNT_FEATURE_REF b on  a.ban=b.ban inner join PRICEKEY_DF c on c.ban =a.ban and b.BM_PRODUCT_ID=c.BM_PRODUCT_ID where  upper(c.BM_PRODUCT_NAME) not in('MODEM','CENTURYLINK @ EASE') and a.dis_cat_mod=0 and a.dis_cat_ease=0"
  },
   {
    "ruleID":"50006",
    "ruleType":"getStructColumn",
    "dataFrameID":"DISCOUNT_HSI_QUERY",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Creating Structure for Discount Details",
    "ruleCategory":"TG",
   // "debugInfo":"rows",
    "ruleText":"DISCOUNT_HSI_QUERY,discounts,autoAttachInd,discountId,discountDescription,discountRate,discountMethod,discountLevel,discountDuration,discountType,discountCategory,discountMaxAmount,discountRule,discountMinimumAmount,discountIdSequence,discountStartDate,discountExpiryDate"
  },
   {
    "ruleID":"50007",
    "ruleType":"getFrozenList",
    "dataFrameID":"DISCOUNT_HSI_QUERY",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a Array Structure for Discount Details",
    "ruleCategory":"TG",
   // "debugInfo":"rows",
    "ruleText":"DISCOUNT_HSI_QUERY,discounts,discounts",
    "keyColumns":"BAN"
  },
    {
    "ruleID":"50008",
    "ruleType":"joinTables",
    "dataFrameID":"HSI_Product_Attributes_TDU",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Joining 2 Staging Tables HSI_Product_Attributes_TDU and DISCOUNT_HSI_QUERY",
    "ruleCategory":"TG",
    "joinType":"left",
    "renameKeys":"Y",
    //"debugInfo":"rows",
    "ruleText":"HSI_Product_Attributes_TDU,BAN,DISCOUNT_HSI_QUERY,BAN"
  },
  {
    "ruleID":"196",
    "ruleType":"executeSQLQuery",
    "dataFrameID":"HSI_Product_Attributes_TDUPRI",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"To Get the HSI Technology/Downspeed/Upspeed Price related Details",
    "ruleCategory":"TG",
//	"debugInfo":"count",
    "ruleText":"select distinct p_key.BAN,BLG_ACCT_TEL_NO,NVL(PRICETYPE,'') as priceType ,NVL(OTC,0) as discountedOtc,cast( (CASE WHEN PRICEDESCRIPTION ='MRC/OTC'AND NVL(RC,0)>0 THEN ((NVL(RC,0)-NVL(discountRate,0))) ELSE (NVL(RC,0)) END) as decimal(9,2)) as discountedRc,NVL(OTC,0) as otc,cast(NVL(RC,0) as decimal(9,2)) as rc,NVL(PRICEDESCRIPTION ,'') as priceTypeDescription,NVL(priceKey,'') as priceKey ,'1' frequency , 'USD' currencyCode from (select aa.BAN,aa.BLG_ACCT_TEL_NO,CONCAT(CATALOG_SPEC_ID, '~', CATALOG_CODE, '~', PRODUCT_OFFER_ID, '~',PriceKey_comp) as priceKey from stg_account_address aa inner join ref_catalog_data cd on cd.state = aa.stateOrProvince and cd.city = aa.city and cd.WIRE_CENTER = aa.wirecenter inner join (select tech.BAN,tech.BLG_ACCT_TEL_NO, BM_PRODUCT_ID, BM_PRODUCT_NAME, RFSID, PRODUCT, PriceKey_comp from ref_usoc_rfsid_bmprod urb inner join (select distinct a.BAN,a.BLG_ACCT_TEL_NO, FEATURE_CODE from BMCONV_FUTURECODE a ) tech on urb.USOC_VAL = tech.FEATURE_CODE Where UPPER(urb.BM_PRODUCT_NAME) != 'MODEM' and UPPER(urb.BM_PRODUCT_NAME) != 'CENTURYLINK @ EASE' ) HSI_Products on aa.BAN = HSI_Products.BAN left join ref_bm_offer_data bod on bod.OFFER_COMPONENT = HSI_Products.BM_PRODUCT_NAME  and bod.ban = HSI_Products.ban) p_key left join (SELECT A.BAN,A.PRICETYPE,A.RC RC,B.discountRate discountRate,0 as OTC,PRICEDESCRIPTION FROM ENS_PRICE A left join  (select ban,sum(discountRate) discountRate from DISCOUNT_QUERY_EXT where discount_CATEORY=0 and discount_CATEORY_EASE=0 group by ban) B on A.BAN = B.BAN) P_BOOK on p_key.BAN=p_BOOK.BAN"
  },
  {
    "ruleID":"199",
    "ruleType":"getStructColumn",
    "dataFrameID":"HSI_Product_Attributes_TDUPRI",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a Structure for HSI Technology/Downspeed/Upspeed-prices",
    "ruleCategory":"TG",
//  "debugInfo":"rows",
    "ruleText":"HSI_Product_Attributes_TDUPRI,prices,priceType,frequency,currencyCode,discountedOtc,discountedRc,otc,rc,priceTypeDescription,priceKey"
  },
  {
    "ruleID":"200",
    "ruleType":"getFrozenList",
    "dataFrameID":"HSI_Product_Attributes_TDUPRI",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a Array Structure HSI Technology/Downspeed/Upspeed - Prices ",
    "ruleCategory":"TG",
 	//"debugInfo":"rows",
    "ruleText":"HSI_Product_Attributes_TDUPRI,prices,prices",
    "keyColumns":"BAN"
  },
  {
    "ruleID":"201",
    "ruleType":"joinTables",
    "dataFrameID":"HSI_Product_Attributes_TDUPRI",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Joining 2 Staging Tables HSI_Product_Attributes_TDUPRI and HSI_Product_Attributes_TDU",
    "ruleCategory":"TG",
    "joinType":"right",
    "renameKeys":"Y",
 	//"debugInfo":"rows",
    "ruleText":"HSI_Product_Attributes_TDUPRI,BAN,HSI_Product_Attributes_TDU,BAN"
  },
  {
    "ruleID":"202",
    "ruleType":"getStructColumn",
    "dataFrameID":"HSI_Product_Attributes_TDUPRI",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a Structure for HSI Technology/Downspeed/Upspeed-productAttributes",
    "ruleCategory":"TG",
 	//"debugInfo":"schema",
    "ruleText":"HSI_Product_Attributes_TDUPRI,productAttributes,isDefault,displayOrder,isPriceable,prices,discounts,compositeAttribute"
  },
  {
    "ruleID":"208",
    "ruleType":"unionTables",
    "dataFrameID":"HSI_Product_Attributes_AL",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"union tables for all HSI PRODUCTS",
    "ruleCategory":"TG",
 //	"debugInfo":"count",
    "ruleText":"HSI_Product_Attributes_AL,HSI_Product_Attributes_TDUPRI"
  },
  {
    "ruleID":"209",
    "ruleType":"getFrozenList",
    "dataFrameID":"HSI_Product_Attributes_AL",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a Array Structure for HSI PRODUCTS",
    "ruleCategory":"TG",
 //  "debugInfo":"rows",
    "ruleText":"HSI_Product_Attributes_AL,productAttributes,productAttributes",
    "keyColumns":"BAN"
  },
  {
    "ruleID":"210",
    "ruleType":"executeSQLQuery",
    "dataFrameID":"HSI_Prod_Att_ALDDPADUTDU_Q",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"TO Get the Product related Details",
    "ruleCategory":"TG",
  //  "debugInfo":"rows",
    "ruleText":"select tech.BAN,tech.BLG_ACCT_TEL_NO, technology, USOC_VAL, BM_PRODUCT_ID as productId, BM_PRODUCT_NAME as productName,RFSID, PRODUCT,productType as productType, componentType as componentType, productCategory as productCategory , 1 quantity , 'ADD' action from ref_usoc_rfsid_bmprod urb inner join ( select distinct a.BAN, a.BLG_ACCT_TEL_NO,FEATURE_CODE  from BMCONV_FUTURECODE a ) tech on urb.USOC_VAL = tech.FEATURE_CODE and UPPER(urb.BM_PRODUCT_NAME) not in ('MODEM', 'CENTURYLINK @ EASE')"
  },
  {
    "ruleID":"213",
    "ruleType":"addColumns",
    "dataFrameID":"HSI_Prod_Att_ALDDPADUTDU_Q",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Adding a new column for product.productAssociations with empty array",
    "ruleCategory":"TG",
    "ruleText":"HSI_Prod_Att_ALDDPADUTDU_Q,productAssociations,array()"
  },
  {
    "ruleID":"214",
    "ruleType":"joinTables",
    "dataFrameID":"HSI_Prod_Att_ALDDPADUTDU_Q",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Joining 2 Staging Tables HSI_Prod_Att_ALDDPADUTDU_Q and HSI_Product_Attributes_AL",
    "ruleCategory":"TG",
    "joinType":"inner",
    "renameKeys":"Y",
 	//"debugInfo":"rows",
    "ruleText":"HSI_Prod_Att_ALDDPADUTDU_Q,BAN,HSI_Product_Attributes_AL,BAN"
  },
  {
    "ruleID":"215",
    "ruleType":"getStructColumn",
    "dataFrameID":"HSI_Prod_Att_COS_HSI",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a structure for customerOrderSubItems ",
    "ruleCategory":"TG",
 //	"debugInfo":"rows",
    "ruleText":"HSI_Prod_Att_ALDDPADUTDU_Q,customerOrderSubItems,quantity,productId,productName,action,productType,componentType,productCategory,productAssociations,productAttributes"
  },
  {
    "ruleID":"217",
    "ruleType":"executeSQLQuery",
    "dataFrameID":"MODEM_Prod_Att_ATCSMS",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"To Get the MODEM (Account Type/Cyber Security/Modem Class)",
    "ruleCategory":"TG",
    //"filter":"attributeName in ('Account Type','Cyber Security','Modem Class')",
    "debugInfo":"rows",
    "ruleText":"select distinct BAN,BLG_ACCT_TEL_NO, BM_PRODUCT_ID, BM_PRODUCT_NAME, ATTRIBUTE_NAME as attributeName ,UPPER(case ATTRIBUTE_NAME when 'Account Type' then Account_Type when 'Cyber Security' then Cyber_Security when 'Modem Class' then Modem_Class  else 'else' end) attributeValue, cast(null as String) uom  from (Select a.BAN,a.BLG_ACCT_TEL_NO, BM_PRODUCT_ID, BM_PRODUCT_NAME, RFSID, PRODUCT, urb.CART_PROD_ATTR_LIST_ID,Account_Type,Cyber_Security, Modem_Class from ref_usoc_rfsid_bmprod urb inner join BMCONV_FUTURECODE a on trim(urb.USOC_VAL) = trim(a.FEATURE_CODE) Where UPPER(urb.BM_PRODUCT_NAME)='MODEM') Modem_Products inner join ref_cart_prod_attr cpa on cpa.CART_PROD_ATTR_LIST_ID = Modem_Products.CART_PROD_ATTR_LIST_ID where ATTRIBUTE_NAME in ('Account Type','Cyber Security','Modem Class')"
  },
    
    {
    "ruleID":"2170",
    "ruleType":"executeSQLQuery",
    "dataFrameID":"INTERDF",
    "persist":"N",
    "ruleStatus":"off",
    "ruleDescription":"To Get the MODEM (Account Type/Cyber Security/Modem Class)",
    "ruleCategory":"TG",
    //"filter":"attributeName in ('Account Type','Cyber Security','Modem Class')",
//  "debugInfo":"rows",
    "ruleText":"select distinct ban from (select ban,collect_set(upper(attributeValue)) attributeValue  from MODEM_Prod_Att_ATCSMS group by ban,attributeName) a where size(attributeValue) > 1"
  },
      {
    "ruleID":"2171",
    "ruleType":"executeSQLQuery",
    "dataFrameID":"MODEM_Prod_Att_ATCSMS",
    "persist":"N",
    "ruleStatus":"off",
    "ruleDescription":"To Get the MODEM (Account Type/Cyber Security/Modem Class)",
    "ruleCategory":"TG",
    //"filter":"attributeName in ('Account Type','Cyber Security','Modem Class')",
//  "debugInfo":"rows",
    "ruleText":"select * from MODEM_Prod_Att_ATCSMS where ban in (select ban from interDF) and attributeValue != 'Disabled'"
  },
  {
    "ruleID":"218",
    "ruleType":"getStructColumn",
    "dataFrameID":"MODEM_Prod_Att_ATCSMS",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a Structure for MODEM (Account Type/Cyber Security/Modem Class)",
    "ruleCategory":"TG",
//  "debugInfo":"rows",
    "ruleText":"MODEM_Prod_Att_ATCSMS,compositeAttribute,attributeName,attributeValue,uom"
  },
  {
    "ruleID":"219",
    "ruleType":"getFrozenList",
    "dataFrameID":"MODEM_Prod_Att_ATCSMS",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a Array Structure for MODEM (Account Type/Cyber Security/Modem Class)",
    "ruleCategory":"TG",
 //	"debugInfo":"rows",
    "ruleText":"MODEM_Prod_Att_ATCSMS,compositeAttribute,compositeAttribute",
    "keyColumns":"BAN"
  },
  {
    "ruleID":"220",
    "ruleType":"addColumns",
    "dataFrameID":"MODEM_Prod_Att_ATCSMS",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Adding a new column for MODEM (Account Type/Cyber Security/Modem Class) - isDefault with 3",
    "ruleCategory":"TG",
    "ruleText":"MODEM_Prod_Att_ATCSMS,isDefault,3"
  },
  {
    "ruleID":"221",
    "ruleType":"addColumns",
    "dataFrameID":"MODEM_Prod_Att_ATCSMS",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Adding a new column for MODEM (Account Type/Cyber Security/Modem Class) - displayOrder with 3",
    "ruleCategory":"TG",
    "ruleText":"MODEM_Prod_Att_ATCSMS,displayOrder,3"
  },
  {
    "ruleID":"222",
    "ruleType":"addColumns",
    "dataFrameID":"MODEM_Prod_Att_ATCSMS",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Adding a new column for MODEM (Account Type/Cyber Security/Modem Class) - isPriceable with true",
    "ruleCategory":"TG",
    "ruleText":"MODEM_Prod_Att_ATCSMS,isPriceable,true"
  },
  {
    "ruleID":"223",
    "ruleType":"addColumns",
    "dataFrameID":"MODEM_Prod_Att_ATCSMS",
    "persist":"N",
    "ruleStatus":"off",
    "ruleDescription":"Adding a new column for MODEM (Account Type/Cyber Security/Modem Class) - discounts with a empty array",
//	"debugInfo":"rows",
    "ruleCategory":"TG",
    "ruleText":"MODEM_Prod_Att_ATCSMS,discounts,array()"
  },
  {
    "ruleID":"60001",
    "ruleType":"executeSQLQuery",
    "dataFrameID":"DISCOUNT_QUERY_MODEM",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"TO Get the Prod Details of modem",
    "ruleCategory":"TG",
//	"debugInfo":"rows",
	"ruleText":"select a.ban,a.autoAttachInd,a.discountId,a.discountDescription,a.discountRate,a.discountMethod,a.discountLevel,a.discountDuration,a.discountType,a.discountCategory, a.discountMaxAmount, a.discountMinimumAmount,a.discountIdSequence,a.discountRule ,a.discountStartDate,a.discountExpiryDate ,b.BM_PRODUCT_ID from DISCOUNT_QUERY a inner  join DISCOUNT_FEATURE_REF b on  a.ban=b.ban inner join PRICEKEY_DF c on c.ban =a.ban and b.BM_PRODUCT_ID=c.BM_PRODUCT_ID where  upper(c.BM_PRODUCT_NAME) ='MODEM' and a.dis_cat_mod>0 and a.dis_cat_ease=0"
  },
  {
    "ruleID":"60003",
    "ruleType":"getStructColumn",
    "dataFrameID":"DISCOUNT_QUERY_MODEM",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Creating Structure for Discount Details",
    "ruleCategory":"TG",
//  "debugInfo":"schema",
    "ruleText":"DISCOUNT_QUERY_MODEM,discounts,autoAttachInd,discountId,discountDescription,discountRate,discountMethod,discountLevel,discountDuration,discountType,discountCategory,discountMaxAmount,discountRule,discountMinimumAmount,discountIdSequence,discountStartDate,discountExpiryDate"
  },
   {
    "ruleID":"60004",
    "ruleType":"getFrozenList",
    "dataFrameID":"DISCOUNT_QUERY_MODEM",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a Array Structure for Discount Details",
    "ruleCategory":"TG",
//  "debugInfo":"schema",
    "ruleText":"DISCOUNT_QUERY_MODEM,discounts,discounts",
    "keyColumns":"BAN"
  },
    {
    "ruleID":"60005",
    "ruleType":"joinTables",
    "dataFrameID":"MODEM_Prod_Att_ATCSMS",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Joining 2 Staging Tables MODEM_Prod_Att_ATCSMS and DISCOUNT_QUERY_MODEM",
    "ruleCategory":"TG",
    "joinType":"left",
    "renameKeys":"Y",
 	//"debugInfo":"rows",
    "ruleText":"MODEM_Prod_Att_ATCSMS,BAN,DISCOUNT_QUERY_MODEM,BAN"
  },
  {
    "ruleID":"224",
    "ruleType":"executeSQLQuery",
    "dataFrameID":"MODEM_Prod_Att_ATCSMSPRI",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"To Get the MODEM (Account Type/Cyber Security/Modem Class) - prices",
    "ruleCategory":"TG",
    "debugInfo":"rows",
    "ruleText":"select p_key.BAN,BLG_ACCT_TEL_NO,NVL(PRICETYPE,'') as priceType , NVL(OTC,0) as discountedOtc,cast( (CASE WHEN PRICEDESCRIPTION ='MRC/OTC'AND NVL(RC,0)>0  THEN ((NVL(RC,0)-NVL(discountRate,0))) ELSE NVL(RC,0) END) as decimal(9,2)) as discountedRc, NVL(OTC,0) as otc,cast(NVL(RC,0) as decimal(9,2)) as rc,NVL(PRICEDESCRIPTION,'') as priceTypeDescription,NVL(priceKey,'') as priceKey ,'1' frequency,'USD' currencyCode from (select aa.BAN,aa.BLG_ACCT_TEL_NO,CONCAT(CATALOG_SPEC_ID, '~', CATALOG_CODE, '~', PRODUCT_OFFER_ID, '~',PriceKey_comp) as priceKey from stg_account_address aa inner join ref_catalog_data cd on cd.state = aa.stateOrProvince and cd.city = aa.city and cd.WIRE_CENTER = aa.wirecenter inner join (select a.BAN,a.BLG_ACCT_TEL_NO, BM_PRODUCT_ID, BM_PRODUCT_NAME, RFSID, PRODUCT, PriceKey_comp from BMCONV_FUTURECODE a inner join ref_usoc_rfsid_bmprod urb on urb.USOC_VAL = a.FEATURE_CODE  Where UPPER(urb.BM_PRODUCT_NAME) ='MODEM') Modem_Products on aa.BAN = Modem_Products.BAN left join ref_bm_offer_data bod on bod.OFFER_COMPONENT = Modem_Products.BM_PRODUCT_NAME and bod.ban = Modem_Products.ban) p_key left join (SELECT A.BAN,A.PRICETYPE,A.RC RC,B.discountRate discountRate,0 as OTC,PRICEDESCRIPTION FROM ENS_PRICE_MODEM A left join  (Select BAN,sum(discountRate) discountRate from DISCOUNT_QUERY_EXT where discount_CATEORY>0 and discount_CATEORY_EASE=0 group by BAN) B  on A.BAN = B.BAN ) P_BOOK on p_key.BAN=p_BOOK.BAN"
  },
  {
    "ruleID":"227",
    "ruleType":"getStructColumn",
    "dataFrameID":"MODEM_Prod_Att_ATCSMSPRI",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a Structure for MODEM (Account Type/Cyber Security/Modem Class) - prices",
    "ruleCategory":"TG",
//	"debugInfo":"schema",
    "ruleText":"MODEM_Prod_Att_ATCSMSPRI,prices,priceType,frequency,currencyCode,discountedOtc,discountedRc,otc,rc,priceTypeDescription,priceKey"
  },
  {
    "ruleID":"228",
    "ruleType":"getFrozenList",
    "dataFrameID":"MODEM_Prod_Att_ATCSMSPRI",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a Array Structure for MODEM (Account Type/Cyber Security/Modem Class) - prices",
    "ruleCategory":"TG",
 	// //  "debugInfo":"rows",
    "ruleText":"MODEM_Prod_Att_ATCSMSPRI,prices,prices",
    "keyColumns":"BAN"
  },
  {
    "ruleID":"229",
    "ruleType":"joinTables",
    "dataFrameID":"MODEM_Prod_Att_ATCSMSPRI",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Joining 2 Staging Tables MODEM_Prod_Att_ATCSMS and MODEM_Prod_Att_ATCSMSPRI ",
    "ruleCategory":"TG",
    "joinType":"inner",
    "renameKeys":"Y",
 //	"debugInfo":"rows",
    "ruleText":"MODEM_Prod_Att_ATCSMS,BAN,MODEM_Prod_Att_ATCSMSPRI,BAN"
  },
  {
    "ruleID":"230",
    "ruleType":"getStructColumn",
    "dataFrameID":"MODEM_Prod_Att_ATCSMSPRI",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a structure for MODEM (Account Type/Cyber Security/Modem Class)-productAttributes",
    "ruleCategory":"TG",
//	"debugInfo":"schema",
    "ruleText":"MODEM_Prod_Att_ATCSMSPRI,productAttributes,isDefault,displayOrder,isPriceable,prices,discounts,compositeAttribute"
  },
  {
    "ruleID":"231",
    "ruleType":"executeSQLQuery",
    "dataFrameID":"MODEM_Prod_Att_AL",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"To Get the Modem-allowMACD attribute name and value",
    "ruleCategory":"TG",
    "filter":"attributeName in ('allowMACD')",
 	// //  "debugInfo":"rows",
    "ruleText":"select BAN,BLG_ACCT_TEL_NO,BM_PRODUCT_ID, ATTRIBUTE_NAME as attributeName,case ATTRIBUTE_NAME when 'Account Type' then Account_Type when 'Cyber Security' then Cyber_Security when 'Modem Class' then Modem_Class when 'ProductActivationDate' then concat(regexp_replace(to_utc_timestamp(current_timestamp(),'PST'),' ','T'),'Z') when 'allowMACD' then 'Y' else 'else' end attributeValue, cast(null as String) uom from  (Select a.BAN,a.BLG_ACCT_TEL_NO, BM_PRODUCT_ID, BM_PRODUCT_NAME, RFSID, PRODUCT, urb.CART_PROD_ATTR_LIST_ID,Account_Type, Cyber_Security, Modem_Class from ref_usoc_rfsid_bmprod urb inner join BMCONV_FUTURECODE a  on urb.USOC_VAL = a.FEATURE_CODE  Where UPPER(urb.BM_PRODUCT_NAME)='MODEM') Modem_Products  inner join ref_cart_prod_attr cpa on cpa.CART_PROD_ATTR_LIST_ID = Modem_Products.CART_PROD_ATTR_LIST_ID where ATTRIBUTE_NAME in ('allowMACD')"
  },
  {
    "ruleID":"232",
    "ruleType":"getStructColumn",
    "dataFrameID":"MODEM_Prod_Att_AL",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a Structure for Modem-allowMACD",
    "ruleCategory":"TG",
//	// //  "debugInfo":"rows",
    "ruleText":"MODEM_Prod_Att_AL,compositeAttribute,attributeName,attributeValue,uom"
  },
  {
    "ruleID":"233",
    "ruleType":"getFrozenList",
    "dataFrameID":"MODEM_Prod_Att_AL",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a Array Structure for Modem-allowMACD",
    "ruleCategory":"TG",
//	// //  "debugInfo":"rows",
    "ruleText":"MODEM_Prod_Att_AL,compositeAttribute,compositeAttribute",
    "keyColumns":"BAN"
  },
  {
    "ruleID":"234",
    "ruleType":"addColumns",
    "dataFrameID":"MODEM_Prod_Att_AL",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Added a column for Modem-allowMACD.isDefault with 3",
    "ruleCategory":"TG",
    "ruleText":"MODEM_Prod_Att_AL,isDefault,3"
  },
  {
    "ruleID":"235",
    "ruleType":"addColumns",
    "dataFrameID":"MODEM_Prod_Att_AL",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Added a column for Modem-allowMACD.displayOrder with 3",
    "ruleCategory":"TG",
    "ruleText":"MODEM_Prod_Att_AL,displayOrder,3"
  },
  {
    "ruleID":"236",
    "ruleType":"addColumns",
    "dataFrameID":"MODEM_Prod_Att_AL",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Added a column for Modem-allowMACD.isPriceable with false",
    "ruleCategory":"TG",
    "ruleText":"MODEM_Prod_Att_AL,isPriceable,false"
  },
  {
    "ruleID":"237",
    "ruleType":"addNullColumn",
    "dataFrameID":"MODEM_Prod_Att_AL",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Added a column for Modem-allowMACD.discounts with empty array",
    "ruleCategory":"TG",
 	//"debugInfo":"schema",
    "ruleText":"MODEM_Prod_Att_AL,discounts,array<struct<autoAttachInd: String,discountId: String, discountDescription: String, discountRate: Decimal(9,2), discountMethod: String, discountLevel: String, discountDuration: Decimal(9,2), discountType: String, discountCategory: String,discountMaxAmount: String,discountRule: String,discountMinimumAmount: String,discountIdSequence: Decimal(7,0),discountStartDate: timestamp,discountExpiryDate: timestamp>>"
  },
  {
    "ruleID":"238",
    "ruleType":"addNullColumn",
    "dataFrameID":"MODEM_Prod_Att_AL",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Added a column for Modem-allowMACD.prices with empty array",
    "ruleCategory":"TG",
    "ruleText":"MODEM_Prod_Att_AL,prices,array<struct<priceType: String,frequency: String, currencyCode: String, discountedOtc: Integer, discountedRc: Decimal(9,2), otc: Integer, rc: Decimal(9,2), priceTypeDescription: String, priceKey: String>>"
  },
  {
    "ruleID":"239",
    "ruleType":"getStructColumn",
    "dataFrameID":"MODEM_Prod_Att_AL",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a structure for Modem-allowMACD.productAttributes ",
    "ruleCategory":"TG",
 	//"debugInfo":"schema",
    "ruleText":"MODEM_Prod_Att_AL,productAttributes,isDefault,displayOrder,isPriceable,prices,discounts,compositeAttribute"
  },
  {
    "ruleID":"240",
    "ruleType":"executeSQLQuery",
    "dataFrameID":"MODEM_Prod_Att_PA",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"To Get the Modem-productActivationDate attribute name and value",
    "ruleCategory":"TG",
    "filter":"attributeName in ('ProductActivationDate')",
 	// //  "debugInfo":"rows",
    "ruleText":"select BAN,BLG_ACCT_TEL_NO,BM_PRODUCT_ID, ATTRIBUTE_NAME as attributeName , case ATTRIBUTE_NAME when 'Account Type' then Account_Type when 'Cyber Security' then Cyber_Security when 'Modem Class' then Modem_Class when 'ProductActivationDate' then concat(regexp_replace(to_utc_timestamp(current_timestamp(),'PST'),' ','T'),'Z') when 'allowMACD' then 'Y'  else 'else' end attributeValue, cast(null as String) uom from  (Select a.BAN,a.BLG_ACCT_TEL_NO, BM_PRODUCT_ID, BM_PRODUCT_NAME, RFSID, PRODUCT, urb.CART_PROD_ATTR_LIST_ID,Account_Type, Cyber_Security, Modem_Class from ref_usoc_rfsid_bmprod urb inner join BMCONV_FUTURECODE a  on urb.USOC_VAL = a.FEATURE_CODE  Where UPPER(urb.BM_PRODUCT_NAME)='MODEM') Modem_Products  inner join ref_cart_prod_attr cpa on cpa.CART_PROD_ATTR_LIST_ID = Modem_Products.CART_PROD_ATTR_LIST_ID where ATTRIBUTE_NAME in ('ProductActivationDate')"
  },
  {
    "ruleID":"241",
    "ruleType":"getStructColumn",
    "dataFrameID":"MODEM_Prod_Att_PA",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a Structure for Modem-productActivationDate.compositeAttribute",
    "ruleCategory":"TG",
//	// //  "debugInfo":"rows",
    "ruleText":"MODEM_Prod_Att_PA,compositeAttribute,attributeName,attributeValue,uom"
  },
  {
    "ruleID":"242",
    "ruleType":"getFrozenList",
    "dataFrameID":"MODEM_Prod_Att_PA",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a Array Structure for Modem-productActivationDate.compositeAttribute",
    "ruleCategory":"TG",
 	// //  "debugInfo":"rows",
    "ruleText":"MODEM_Prod_Att_PA,compositeAttribute,compositeAttribute",
    "keyColumns":"BAN"
  },
  {
    "ruleID":"243",
    "ruleType":"addColumns",
    "dataFrameID":"MODEM_Prod_Att_PA",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Adding a new column for Modem-productActivationDate.isDefault with 3",
    "ruleCategory":"TG",
    "ruleText":"MODEM_Prod_Att_PA,isDefault,3"
  },
  {
    "ruleID":"244",
    "ruleType":"addColumns",
    "dataFrameID":"MODEM_Prod_Att_PA",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Adding a new column for Modem-productActivationDate.displayOrder with 3",
    "ruleCategory":"TG",
    "ruleText":"MODEM_Prod_Att_PA,displayOrder,3"
  },
  {
    "ruleID":"245",
    "ruleType":"addColumns",
    "dataFrameID":"MODEM_Prod_Att_PA",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Adding a new column for Modem-productActivationDate.isPriceable with false",
    "ruleCategory":"TG",
    "ruleText":"MODEM_Prod_Att_PA,isPriceable,false"
  },
  {
    "ruleID":"246",
    "ruleType":"addNullColumn",
    "dataFrameID":"MODEM_Prod_Att_PA",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Adding a new column for Modem-productActivationDate.discounts with empty array",
    "ruleCategory":"TG",
//	"debugInfo":"schema",
    "ruleText":"MODEM_Prod_Att_PA,discounts,array<struct<autoAttachInd: String,discountId: String, discountDescription: String, discountRate: Decimal(9,2), discountMethod: String, discountLevel: String, discountDuration: Decimal(9,2), discountType: String, discountCategory: String,discountMaxAmount: String,discountRule: String,discountMinimumAmount: String,discountIdSequence: Decimal(7,0),discountStartDate: timestamp,discountExpiryDate: timestamp>>"
  },
  {
    "ruleID":"247",
    "ruleType":"addNullColumn",
    "dataFrameID":"MODEM_Prod_Att_PA",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Adding a new column for Modem-productActivationDate.prices",
    "ruleCategory":"TG",
    "ruleText":"MODEM_Prod_Att_PA,prices,array<struct<priceType: String,frequency: String, currencyCode: String, discountedOtc: Integer, discountedRc: Decimal(9,2), otc: Integer, rc: Decimal(9,2), priceTypeDescription: String, priceKey: String>>"
  },
  {
    "ruleID":"248",
    "ruleType":"getStructColumn",
    "dataFrameID":"MODEM_Prod_Att_PA",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a structure for Modem.productAttributes",
    "ruleCategory":"TG",
//	"debugInfo":"schema",
    "ruleText":"MODEM_Prod_Att_PA,productAttributes,isDefault,displayOrder,isPriceable,prices,discounts,compositeAttribute"
  },
  {
    "ruleID":"249",
    "ruleType":"unionTables",
    "dataFrameID":"MODEM_Prod_Att_ATCSMS_AL_PA",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"union tables for MODEM_PROD_ATT_PA,MODEM_PROD_ATT_AL,MODEM_PROD_ATT_ATCSMSPRI",
    "ruleCategory":"TG",
 	// //  "debugInfo":"rows",
    "ruleText":"MODEM_PROD_ATT_PA,MODEM_PROD_ATT_AL,MODEM_PROD_ATT_ATCSMSPRI"
  },
  {
    "ruleID":"250",
    "ruleType":"getFrozenList",
    "dataFrameID":"MODEM_Prod_Att_ATCSMS_AL_PA",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a Array Structure for MODEM",
    "ruleCategory":"TG",
    "ruleText":"MODEM_Prod_Att_ATCSMS_AL_PA,productAttributes,productAttributes",
    "keyColumns":"BAN"
  },
  {
    "ruleID":"251",
    "ruleType":"executeSQLQuery",
    "dataFrameID":"MODEM_Prod_Att_ATCSMS_AL_PA_Q",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"To Get the MODEM Product",
    "ruleCategory":"TG",
//    "debugInfo":"rows",
    "ruleText":"select a.BAN,a.BLG_ACCT_TEL_NO, BM_PRODUCT_ID as productId, BM_PRODUCT_NAME as productName, RFSID, PRODUCT,urb.productType as productType, urb.componentType as componentType, urb.productCategory as productCategory from BMCONV_FUTURECODE a inner join ref_usoc_rfsid_bmprod urb on urb.USOC_VAL = a.FEATURE_CODE and UPPER(urb.BM_PRODUCT_NAME) = 'MODEM' "
  },
  {
    "ruleID":"252",
    "ruleType":"addColumns",
    "dataFrameID":"MODEM_Prod_Att_ATCSMS_AL_PA_Q",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Adding a new column for MODEM-Product.quantity with 1",
    "ruleCategory":"TG",
    "ruleText":"MODEM_Prod_Att_ATCSMS_AL_PA_Q,quantity,1"
  },
  {
    "ruleID":"253",
    "ruleType":"addColumns",
    "dataFrameID":"MODEM_Prod_Att_ATCSMS_AL_PA_Q",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Adding a new column for MODEM-Product.action with ADD",
    "ruleCategory":"TG",
    "ruleText":"MODEM_Prod_Att_ATCSMS_AL_PA_Q,action,'ADD'"
  },
  {
    "ruleID":"254",
    "ruleType":"addColumns",
    "dataFrameID":"MODEM_Prod_Att_ATCSMS_AL_PA_Q",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Adding a new column for MODEM-Product.productAssociations with empty array",
    "ruleCategory":"TG",
    "ruleText":"MODEM_Prod_Att_ATCSMS_AL_PA_Q,productAssociations,array()"
  },
  {
    "ruleID":"255",
    "ruleType":"joinTables",
    "dataFrameID":"MODEM_Prod_Att_ATCSMS_AL_PA_F",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Joining 2 Staging Tables for MODEM_Prod_Att_ATCSMS_AL_PA_Q and MODEM_Prod_Att_ATCSMS_AL_PA",
    "ruleCategory":"TG",
    "joinType":"inner",
    "renameKeys":"Y",
 	// //  "debugInfo":"rows",
    "ruleText":"MODEM_Prod_Att_ATCSMS_AL_PA_Q,BAN,MODEM_Prod_Att_ATCSMS_AL_PA,BAN"
  },
  {
    "ruleID":"256",
    "ruleType":"getStructColumn",
    "dataFrameID":"MODEM_Prod_Att_COS_HSI",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a structure for Modem customerOrderSubItems ",
    "ruleCategory":"TG",
 	"debugInfo":"rows",
    "ruleText":"MODEM_Prod_Att_ATCSMS_AL_PA_F,customerOrderSubItems,quantity,productId,productName,action,productType,componentType,productCategory,productAssociations,productAttributes"
  },
{
    "ruleID":"257",
    "ruleType":"dropColumns",
    "dataFrameID":"HSI_PROD_ATT_COS_HSI",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Removing the column ",
    "ruleCategory":"TG",
    "ruleText":"HSI_PROD_ATT_COS_HSI,technology,usoc_val"
},
 {
    "ruleID":"70000",
    "ruleType":"executeSQLQuery",
    "dataFrameID":"EASE_Prod_Att_SL",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"To Get the EASE (Service Level)",
    "ruleCategory":"TG",
    "filter":"attributeName in ('Service Level')",
 	// //  "debugInfo":"rows",
    "ruleText":"select BAN,BLG_ACCT_TEL_NO, BM_PRODUCT_ID, BM_PRODUCT_NAME, ATTRIBUTE_NAME as attributeName ,case ATTRIBUTE_NAME when 'Service Level' then Service_Level else 'else' end attributeValue,cast(null as String) uom from (Select a.BAN,a.BLG_ACCT_TEL_NO, BM_PRODUCT_ID, BM_PRODUCT_NAME, RFSID, PRODUCT, urb.CART_PROD_ATTR_LIST_ID,Service_level from ref_usoc_rfsid_bmprod urb inner join BMCONV_FUTURECODE a on urb.USOC_VAL = a.FEATURE_CODE Where UPPER(urb.BM_PRODUCT_NAME)='CENTURYLINK @ EASE') EASE_Products inner join ref_cart_prod_attr cpa on cpa.CART_PROD_ATTR_LIST_ID = EASE_Products.CART_PROD_ATTR_LIST_ID where ATTRIBUTE_NAME in ('Service Level')"
  },
  {
    "ruleID":"70001",
    "ruleType":"getStructColumn",
    "dataFrameID":"EASE_Prod_Att_SL",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a Structure for EASE (Service_level)",
    "ruleCategory":"TG",
//	// //  "debugInfo":"rows",
    "ruleText":"EASE_Prod_Att_SL,compositeAttribute,attributeName,attributeValue,uom"
  },
  {
    "ruleID":"70002",
    "ruleType":"getFrozenList",
    "dataFrameID":"EASE_Prod_Att_SL",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a Array Structure for EASE (Service_level)",
    "ruleCategory":"TG",
//	// //  "debugInfo":"rows",
    "ruleText":"EASE_Prod_Att_SL,compositeAttribute,compositeAttribute",
    "keyColumns":"BAN"
  },
  {
    "ruleID":"70003",
    "ruleType":"addColumns",
    "dataFrameID":"EASE_Prod_Att_SL",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Adding a new column for EASE (Service_level) - isDefault with 3",
    "ruleCategory":"TG",
    "ruleText":"EASE_Prod_Att_SL,isDefault,3"
  },
  {
    "ruleID":"70004",
    "ruleType":"addColumns",
    "dataFrameID":"EASE_Prod_Att_SL",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Adding a new column for EASE (Service_level) - displayOrder with 3",
    "ruleCategory":"TG",
    "ruleText":"EASE_Prod_Att_SL,displayOrder,3"
  },
  {
    "ruleID":"70005",
    "ruleType":"addColumns",
    "dataFrameID":"EASE_Prod_Att_SL",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Adding a new column for EASE (Service_level) - isPriceable with true",
    "ruleCategory":"TG",
    "ruleText":"EASE_Prod_Att_SL,isPriceable,true"
  },
 {
    "ruleID":"70006",
    "ruleType":"addColumns",
    "dataFrameID":"EASE_Prod_Att_SL",
    "persist":"N",
    "ruleStatus":"off",
    "ruleDescription":"Adding a new column for EASE (Service_level)  - discounts with a empty array",
    "ruleCategory":"TG",
    "ruleText":"EASE_Prod_Att_SL,discounts,array()"
  },
   {
    "ruleID":"70007",
    "ruleType":"extractCON",
    "dataFrameID":"DISCOUNT_QUERY_EASE",
    "persist":"Y",
    "ruleStatus":"on",
    "ruleDescription":"To Get the Discount related Details",
    "ruleCategory":"EG",
    "sourceType":"jdbc",
    "fetchSize":"10000",
	"numberOfPartitions":"16",
	"debugInfo":"PARTITIONS",
    "connectionName":"udmfcon_bppconnection2",
    "ruleText":"Select /*+ PARALLEL(8) */ distinct a.ban,a.PRODUCT_ID,'Y' autoAttachInd,trim(b.Discount_PLAN_CD) discountId,b.discount_desc discountDescription,b.FLAT_AMT discountRate ,b.DISC_QTY_TYPE discountMethod,b.DISCOUNT_PLAN_LEVEL discountLevel,b.DISCOUNT_DURATION discountDuration,b.DISPLAY_TYPE discountType,'RCD' discountCategory,CAST(b.MAX_DISCOUNT_AMT as Varchar2(100)) discountMaxAmount, 'A' discountRule,cast( b.MIN_AMT as Varchar2(100)) discountMinimumAmount,b.DISCOUNT_RANKING discountIdSequence,a.EFFECTIVE_DATE discountStartDate,a.EXPIRATION_DATE discountExpiryDate from cuappc.ban_discount@enspetlink a,cuappc.DISCOUNT_PLAN@enspetlink b,cuappc.billing_account@enspetlink c where a.ban=c.ban and a.DISCOUNT_CODE=b.DISCOUNT_PLAN_CD and c.BAN_STATUS = 'O' and c.customer_type = 'I' and a.Product_type in ('WA') and a.EXPIRATION_DATE > SYSDATE and a.BAN IN (Select distinct BAN from LC_BM_CON_STATUS_10_C LC where LC.DQ_STATUS='N' )and UPPER(b.DISCOUNT_DESC) LIKE '%AT EASE%'"
  },
   {
    "ruleID":"70008",
    "ruleType":"executeSQLQuery",
    "dataFrameID":"DISCOUNT_QUERY_EASE",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"TO Get the Prod Details",
    "ruleCategory":"TG",
 	// //  "debugInfo":"rows",
	"ruleText":"select a.*,b.BM_PRODUCT_ID from DISCOUNT_QUERY_EASE a,DISCOUNT_FEATURE_REF b where a.ban=b.ban"
  },
     {
    "ruleID":"70009",
    "ruleType":"executeSQLQuery",
    "dataFrameID":"DISCOUNT_EASE_QUERY",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"TO Get the EASE Prod ",
    "ruleCategory":"TG",
//	// //  "debugInfo":"rows",
	"ruleText":"select a.* from DISCOUNT_QUERY_EASE a,PRICEKEY_DF b where a.ban=b.ban and a.BM_PRODUCT_ID=b.BM_PRODUCT_ID and UPPER(b.BM_PRODUCT_NAME) ='CENTURYLINK @ EASE'"
  },
  {
    "ruleID":"70010",
    "ruleType":"getStructColumn",
    "dataFrameID":"DISCOUNT_QUERY_STRUCT_EASE",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Creating Structure for Discount Details",
    "ruleCategory":"TG",
    // //  "debugInfo":"rows",
    "ruleText":"DISCOUNT_EASE_QUERY,discounts,autoAttachInd,discountId,discountDescription,discountRate,discountMethod,discountLevel,discountDuration,discountType,discountCategory,discountMaxAmount,discountRule,discountMinimumAmount,discountIdSequence,discountStartDate,discountExpiryDate"
  },
   {
    "ruleID":"70011",
    "ruleType":"getFrozenList",
    "dataFrameID":"DISCOUNT_QUERY_ARRAY_EASE",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a Array Structure for Discount Details",
    "ruleCategory":"TG",
//  "debugInfo":"schema",
    "ruleText":"DISCOUNT_QUERY_STRUCT_EASE,discounts,discounts",
    "keyColumns":"BAN"
  },
      {
    "ruleID":"70012",
    "ruleType":"joinTables",
    "dataFrameID":"EASE_Prod_Att_SL",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Joining 2 Staging Tables EASE_Prod_Att_SL and DISCOUNT_QUERY_ARRAY_EASE",
    "ruleCategory":"TG",
    "joinType":"left",
    "renameKeys":"Y",
 	// //  "debugInfo":"rows",
    "ruleText":"EASE_Prod_Att_SL,BAN,DISCOUNT_QUERY_ARRAY_EASE,BAN"
  },
   {
    "ruleID":"70013",
    "ruleType":"addColumns",
    "dataFrameID":"EASE_Prod_Att_SL_PRI",
    "persist":"N",
    "ruleStatus":"off",
    "ruleDescription":"Adding a new column for EASE (Service_level)  - prices with a empty array",
    "ruleCategory":"TG",
    "ruleText":"EASE_Prod_Att_SL,prices,array()"
  },
  {
    "ruleID":"70014",
    "ruleType":"executeSQLQuery",
    "dataFrameID":"EASE_Prod_Att_SL_PRI",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"To Get the EASE (Service Level) - prices",
    "ruleCategory":"TG",
	// //  "debugInfo":"rows",
    "ruleText":"select p_key.BAN,BLG_ACCT_TEL_NO,NVL(PRICETYPE,'') as priceType , NVL(OTC,0) as discountedOtc,cast( (CASE WHEN PRICEDESCRIPTION ='MRC/OTC' AND NVL(RC,0)>0 THEN ((NVL(RC,0)-NVL(discountRate,0))) ELSE NVL(RC,0) END) as decimal(9,2)) as discountedRc, NVL(OTC,0) as otc,cast(NVL(RC,0) as decimal(9,2)) as rc,NVL(PRICEDESCRIPTION,'') as priceTypeDescription,NVL(priceKey,'') as priceKey from (select aa.BAN,aa.BLG_ACCT_TEL_NO,CONCAT(CATALOG_SPEC_ID, '~', CATALOG_CODE, '~', PRODUCT_OFFER_ID, '~',PriceKey_comp) as priceKey from stg_account_address aa inner join ref_catalog_data cd on cd.state = aa.stateOrProvince and cd.city = aa.city and cd.WIRE_CENTER = aa.wirecenter inner join (select a.BAN,a.BLG_ACCT_TEL_NO, BM_PRODUCT_ID, BM_PRODUCT_NAME, RFSID, PRODUCT, PriceKey_comp from BMCONV_FUTURECODE a inner join ref_usoc_rfsid_bmprod urb on urb.USOC_VAL = a.FEATURE_CODE  Where UPPER(urb.BM_PRODUCT_NAME) = 'CENTURYLINK @ EASE') Modem_Products on aa.BAN = Modem_Products.BAN left join ref_bm_offer_data bod on bod.OFFER_COMPONENT = Modem_Products.BM_PRODUCT_NAME and bod.ban = Modem_Products.ban) p_key left join (SELECT A.BAN,A.PRICETYPE,A.RC RC,B.discountRate discountRate,0 as OTC,PRICEDESCRIPTION FROM ENS_PRICE_EASE A left join  (Select BAN,sum(discountRate) discountRate from DISCOUNT_QUERY_EXT where discount_CATEORY_EASE>0 group by BAN) B on A.BAN = B.BAN ) P_BOOK on p_key.BAN=p_BOOK.BAN"
  },
  {
    "ruleID":"70015",
    "ruleType":"addColumns",
    "dataFrameID":"EASE_Prod_Att_SL_PRI",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"To Get the EASE (Service Level) - prices.frequency with 1",
    "ruleCategory":"TG",
    "ruleText":"EASE_Prod_Att_SL_PRI,frequency,'1'"
  },
  {
    "ruleID":"70016",
    "ruleType":"addColumns",
    "dataFrameID":"EASE_Prod_Att_SL_PRI",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"To Get the EASE (Service Level) - prices.currencyCode with USD",
    "ruleCategory":"TG",
    "ruleText":"EASE_Prod_Att_SL_PRI,currencyCode,'USD'"
  },
  {
    "ruleID":"70017",
    "ruleType":"getStructColumn",
    "dataFrameID":"EASE_Prod_Att_SL_PRI",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a Structure for EASE (Service Level) - prices",
    "ruleCategory":"TG",
 	//"debugInfo":"schema",
    "ruleText":"EASE_Prod_Att_SL_PRI,prices,priceType,frequency,currencyCode,discountedOtc,discountedRc,otc,rc,priceTypeDescription,priceKey"
  },
  {
    "ruleID":"70018",
    "ruleType":"getFrozenList",
    "dataFrameID":"EASE_Prod_Att_SL_PRI",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a Array Structure for EASE (Service Level) - prices",
    "ruleCategory":"TG",
//	// //  "debugInfo":"rows",
    "ruleText":"EASE_Prod_Att_SL_PRI,prices,prices",
    "keyColumns":"BAN"
  },
  {
    "ruleID":"70019",
    "ruleType":"joinTables",
    "dataFrameID":"EASE_Prod_Att_SLPRI",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Joining 2 Staging Tables EASE_Prod_Att_SL and EASE_Prod_Att_SL_PRI ",
    "ruleCategory":"TG",
    "joinType":"inner",
    "renameKeys":"Y",
 	// //  "debugInfo":"rows",
    "ruleText":"EASE_Prod_Att_SL,BAN,EASE_Prod_Att_SL_PRI,BAN"
  },
 {
    "ruleID":"70020",
    "ruleType":"getStructColumn",
    "dataFrameID":"EASE_Prod_Att_SLPRI",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a structure for EASE (Service_level)  - discounts with a empty array",
    "ruleCategory":"TG",
	//"debugInfo":"schema",
    "ruleText":"EASE_Prod_Att_SLPRI,productAttributes,isDefault,displayOrder,isPriceable,prices,discounts,compositeAttribute"
  },
 {
    "ruleID":"70021",
    "ruleType":"executeSQLQuery",
    "dataFrameID":"EASE_Prod_Att_AL",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"To Get the EASE-allowMACD attribute name and value",
    "ruleCategory":"TG",
    "filter":"attributeName in ('allowMACD')",
 	// //  "debugInfo":"rows",
    "ruleText":"select BAN,BLG_ACCT_TEL_NO,BM_PRODUCT_ID, ATTRIBUTE_NAME as attributeName,case ATTRIBUTE_NAME when 'allowMACD' then 'Y' else 'else' end attributeValue, cast(null as String) uom from  (Select a.BAN,a.BLG_ACCT_TEL_NO, BM_PRODUCT_ID, BM_PRODUCT_NAME, RFSID, PRODUCT, urb.CART_PROD_ATTR_LIST_ID,Account_Type, Cyber_Security, Modem_Class from ref_usoc_rfsid_bmprod urb inner join BMCONV_FUTURECODE a  on urb.USOC_VAL = a.FEATURE_CODE  Where UPPER(urb.BM_PRODUCT_NAME)='CENTURYLINK @ EASE') EASE_Products  inner join ref_cart_prod_attr cpa on cpa.CART_PROD_ATTR_LIST_ID = EASE_Products.CART_PROD_ATTR_LIST_ID where ATTRIBUTE_NAME in ('allowMACD')"
  },
  {
    "ruleID":"70022",
    "ruleType":"getStructColumn",
    "dataFrameID":"EASE_Prod_Att_AL",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a Structure for EASE-allowMACD",
    "ruleCategory":"TG",
//	// //  "debugInfo":"rows",
    "ruleText":"EASE_Prod_Att_AL,compositeAttribute,attributeName,attributeValue,uom"
  },
  {
    "ruleID":"70023",
    "ruleType":"getFrozenList",
    "dataFrameID":"EASE_Prod_Att_AL",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a Array Structure for EASE-allowMACD",
    "ruleCategory":"TG",
 	// //  "debugInfo":"rows",
    "ruleText":"EASE_Prod_Att_AL,compositeAttribute,compositeAttribute",
    "keyColumns":"BAN"
  },
  {
    "ruleID":"70024",
    "ruleType":"addColumns",
    "dataFrameID":"EASE_Prod_Att_AL",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Added a column for EASE-allowMACD.isDefault with 0",
    "ruleCategory":"TG",
    "ruleText":"EASE_Prod_Att_AL,isDefault,0"
  },
  {
    "ruleID":"70025",
    "ruleType":"addColumns",
    "dataFrameID":"EASE_Prod_Att_AL",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Added a column for Ease-allowMACD.displayOrder with 0",
    "ruleCategory":"TG",
    "ruleText":"EASE_Prod_Att_AL,displayOrder,0"
  },
  {
    "ruleID":"70026",
    "ruleType":"addColumns",
    "dataFrameID":"EASE_Prod_Att_AL",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Added a column for Ease-allowMACD.isPriceable with false",
    "ruleCategory":"TG",
    "ruleText":"EASE_Prod_Att_AL,isPriceable,false"
  },
  {
    "ruleID":"70027",
    "ruleType":"addNullColumn",
    "dataFrameID":"EASE_Prod_Att_AL",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Added a column for Ease-allowMACD.discounts with empty array",
    "ruleCategory":"TG",
 	//"debugInfo":"schema",
    "ruleText":"EASE_Prod_Att_AL,discounts,array<struct<autoAttachInd: String,discountId: String, discountDescription: String, discountRate: Decimal(9,2), discountMethod: String, discountLevel: String, discountDuration: Decimal(9,2), discountType: String, discountCategory: String,discountMaxAmount: String,discountRule: String,discountMinimumAmount: String,discountIdSequence: Decimal(7,0),discountStartDate: timestamp,discountExpiryDate: timestamp>>"
  },
  {
    "ruleID":"70028",
    "ruleType":"addNullColumn",
    "dataFrameID":"EASE_Prod_Att_AL",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Added a column for Ease-allowMACD.prices with empty array",
    "ruleCategory":"TG",
 	//"debugInfo":"schema",
    "ruleText":"EASE_Prod_Att_AL,prices,array<struct<priceType: String,frequency: String, currencyCode: String, discountedOtc: Integer, discountedRc: Decimal(9,2), otc: Integer, rc: Decimal(9,2), priceTypeDescription: String, priceKey: String>>"
  },
  {
    "ruleID":"70029",
    "ruleType":"getStructColumn",
    "dataFrameID":"EASE_Prod_Att_AL",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a structure for Ease-allowMACD.productAttributes ",
    "ruleCategory":"TG",
 	//"debugInfo":"schema",
    "ruleText":"EASE_Prod_Att_AL,productAttributes,isDefault,displayOrder,isPriceable,prices,discounts,compositeAttribute"
  },
   {
    "ruleID":"70030",
    "ruleType":"executeSQLQuery",
    "dataFrameID":"EASE_Prod_Att_PA",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"To Get the EASE-ProductActivationDate attribute name and value",
    "ruleCategory":"TG",
    "filter":"attributeName in ('ProductActivationDate')",
 	// //  "debugInfo":"rows",
    "ruleText":"select BAN,BLG_ACCT_TEL_NO,BM_PRODUCT_ID, ATTRIBUTE_NAME as attributeName,case ATTRIBUTE_NAME when 'ProductActivationDate' then concat(regexp_replace(to_utc_timestamp(current_timestamp(),'PST'),' ','T'),'Z') else 'else' end attributeValue, cast(null as String) uom from  (Select a.BAN,a.BLG_ACCT_TEL_NO, BM_PRODUCT_ID, BM_PRODUCT_NAME, RFSID, PRODUCT, urb.CART_PROD_ATTR_LIST_ID,Account_Type, Cyber_Security, Modem_Class from ref_usoc_rfsid_bmprod urb inner join BMCONV_FUTURECODE a  on urb.USOC_VAL = a.FEATURE_CODE  Where UPPER(urb.BM_PRODUCT_NAME)='CENTURYLINK @ EASE') EASE_Products  inner join ref_cart_prod_attr cpa on cpa.CART_PROD_ATTR_LIST_ID = EASE_Products.CART_PROD_ATTR_LIST_ID where ATTRIBUTE_NAME in ('ProductActivationDate')"
  },
  {
    "ruleID":"70031",
    "ruleType":"getStructColumn",
    "dataFrameID":"EASE_Prod_Att_PA",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a Structure for EASE-ProductActivationDate",
    "ruleCategory":"TG",
//	// //  "debugInfo":"rows",
    "ruleText":"EASE_Prod_Att_PA,compositeAttribute,attributeName,attributeValue,uom"
  },
  {
    "ruleID":"70032",
    "ruleType":"getFrozenList",
    "dataFrameID":"EASE_Prod_Att_PA",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a Array Structure for EASE-ProductActivationDate",
    "ruleCategory":"TG",
 	// //  "debugInfo":"rows",
    "ruleText":"EASE_Prod_Att_PA,compositeAttribute,compositeAttribute",
    "keyColumns":"BAN"
  },
  {
    "ruleID":"70033",
    "ruleType":"addColumns",
    "dataFrameID":"EASE_Prod_Att_PA",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Added a column for EASE-ProductActivationDate.isDefault with 0",
    "ruleCategory":"TG",
    "ruleText":"EASE_Prod_Att_PA,isDefault,0"
  },
  {
    "ruleID":"70034",
    "ruleType":"addColumns",
    "dataFrameID":"EASE_Prod_Att_PA",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Added a column for Ease-ProductActivationDate.displayOrder with 0",
    "ruleCategory":"TG",
    "ruleText":"EASE_Prod_Att_PA,displayOrder,0"
  },
  {
    "ruleID":"70035",
    "ruleType":"addColumns",
    "dataFrameID":"EASE_Prod_Att_PA",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Added a column for Ease-ProductActivationDate.isPriceable with false",
    "ruleCategory":"TG",
    "ruleText":"EASE_Prod_Att_PA,isPriceable,false"
  },
  {
    "ruleID":"70036",
    "ruleType":"addNullColumn",
    "dataFrameID":"EASE_Prod_Att_PA",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Added a column for Ease-ProductActivationDate.discounts with empty array",
    "ruleCategory":"TG",
//	"debugInfo":"schema",
    "ruleText":"EASE_Prod_Att_PA,discounts,array<struct<autoAttachInd: String,discountId: String, discountDescription: String, discountRate: Decimal(9,2), discountMethod: String, discountLevel: String, discountDuration: Decimal(9,2), discountType: String, discountCategory: String,discountMaxAmount: String,discountRule: String,discountMinimumAmount: String,discountIdSequence: Decimal(7,0),discountStartDate: timestamp,discountExpiryDate: timestamp>>"
  },
  {
    "ruleID":"70037",
    "ruleType":"addNullColumn",
    "dataFrameID":"EASE_Prod_Att_PA",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Added a column for Ease-ProductActivationDate.prices with empty array",
    "ruleCategory":"TG",
//	"debugInfo":"schema",
    "ruleText":"EASE_Prod_Att_PA,prices,array<struct<priceType: String,frequency: String, currencyCode: String, discountedOtc: Integer, discountedRc: Decimal(9,2), otc: Integer, rc: Decimal(9,2), priceTypeDescription: String, priceKey: String>>"
  },
  {
    "ruleID":"70038",
    "ruleType":"getStructColumn",
    "dataFrameID":"EASE_Prod_Att_PA",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a structure for Ease-ProductActivationDate.productAttributes ",
    "ruleCategory":"TG",
 	//"debugInfo":"schema",
    "ruleText":"EASE_Prod_Att_PA,productAttributes,isDefault,displayOrder,isPriceable,prices,discounts,compositeAttribute"
  },
   {
    "ruleID":"70039",
    "ruleType":"unionTables",
    "dataFrameID":"EASE_Prod_Att_SL_AL_PA",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"union tables for EASE",
    "ruleCategory":"TG",
 	//"debugInfo":"schema",
    "ruleText":"EASE_Prod_Att_SLPRI,EASE_Prod_Att_AL,EASE_Prod_Att_PA"
  },
  {
    "ruleID":"70040",
    "ruleType":"getFrozenList",
    "dataFrameID":"EASE_Prod_Att_SL_AL_PA",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a Array Structure for EASE",
    "ruleCategory":"TG",
    "ruleText":"EASE_Prod_Att_SL_AL_PA,productAttributes,productAttributes",
    "keyColumns":"BAN"
  },
   {
    "ruleID":"70041",
    "ruleType":"executeSQLQuery",
    "dataFrameID":"EASE_Prod_Att_SL_AL_PA_Q",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"To Get the EASE Product",
    "ruleCategory":"TG",
	// //  "debugInfo":"rows",
    "ruleText":"select a.BAN,a.BLG_ACCT_TEL_NO, BM_PRODUCT_ID as productId, BM_PRODUCT_NAME as productName, RFSID, PRODUCT,urb.productType as productType, urb.componentType as componentType, urb.productCategory as productCategory from BMCONV_FUTURECODE a inner join ref_usoc_rfsid_bmprod urb on urb.USOC_VAL = a.FEATURE_CODE and UPPER(urb.BM_PRODUCT_NAME) = 'CENTURYLINK @ EASE'"
  },
  {
    "ruleID":"70042",
    "ruleType":"addColumns",
    "dataFrameID":"EASE_Prod_Att_SL_AL_PA_Q",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Adding a new column for MODEM-Product.quantity with 1",
    "ruleCategory":"TG",
    "ruleText":"EASE_Prod_Att_SL_AL_PA_Q,quantity,1"
  },
  {
    "ruleID":"70043",
    "ruleType":"addColumns",
    "dataFrameID":"EASE_Prod_Att_SL_AL_PA_Q",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Adding a new column for MODEM-Product.action with ADD",
    "ruleCategory":"TG",
    "ruleText":"EASE_Prod_Att_SL_AL_PA_Q,action,'ADD'"
  },
  {
    "ruleID":"70044",
    "ruleType":"addColumns",
    "dataFrameID":"EASE_Prod_Att_SL_AL_PA_Q",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Adding a new column for MODEM-Product.productAssociations with empty array",
    "ruleCategory":"TG",
    "ruleText":"EASE_Prod_Att_SL_AL_PA_Q,productAssociations,array()"
  },
  {
    "ruleID":"70045",
    "ruleType":"joinTables",
    "dataFrameID":"EASE_Prod_Att_SL_AL_PA_F",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Joining 2 Staging Tables for EASE_Prod_Att_SL_AL_PA_Q and EASE_Prod_Att_SL_AL_PA",
    "ruleCategory":"TG",
    "joinType":"inner",
    "renameKeys":"Y",
 	// //  "debugInfo":"rows",
    "ruleText":"EASE_Prod_Att_SL_AL_PA_Q,BAN,EASE_Prod_Att_SL_AL_PA,BAN"
  },
  {
    "ruleID":"70046",
    "ruleType":"getStructColumn",
    "dataFrameID":"EASE_Prod_Att_COS_HSI",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a structure for Ease customerOrderSubItems ",
    "ruleCategory":"TG",
 	//"debugInfo":"schema",
    "ruleText":"EASE_Prod_Att_SL_AL_PA_F,customerOrderSubItems,quantity,productId,productName,action,productType,componentType,productCategory,productAssociations,productAttributes"
  },
   {
    "ruleID":"70047",
    "ruleType":"unionTables",
    "dataFrameID":"HSI_MODEM_COS_EASE",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"union tables for HSI,MODEM and EASE",
    "ruleCategory":"TG",
 // "debugInfo":"rows",
    "ruleText":"HSI_PROD_ATT_COS_HSI,MODEM_PROD_ATT_COS_HSI,EASE_Prod_Att_COS_HSI"
  },
  {
    "ruleID":"70048",
    "ruleType":"getFrozenList",
    "dataFrameID":"HSI_MODEM_COS_EASE",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a Array Structure for HSI_MODEM.customerOrderSubItems",
    "ruleCategory":"TG",
 //   "debugInfo": "rows",
    "ruleText":"HSI_MODEM_COS_EASE,customerOrderSubItems,customerOrderSubItems",
    "keyColumns":"BAN"
  },
  {
    "ruleID":"260",
    "ruleType":"selectColumns",
    "dataFrameID":"catalog_id",
    "persist":"N",
    "ruleStatus":"on",
    "ruleCategory":"TG",
   // //  "debugInfo":"rows",
    "ruleText":"CDS_BMCONV_ACCOUNT_CASE2,BAN,BLG_ACCT_TEL_NO,serviceAddress.city,serviceAddress.stateOrProvince,serviceAddress.locationAttributes.wirecenter",
    "ruleDescription":"Select required columns to add catalog_id"
  },
  {
    "ruleID":"261",
    "ruleType":"executeSQLQuery",
    "dataFrameID":"HSI_Prod_Att_COS_HSI_CAT",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Adding a new column CATALOG",
    "ruleCategory":"TG",
   //"debugInfo":"rows",
    "ruleText":"Select b.BAN,b.BLG_ACCT_TEL_NO,a.CATALOG_CODE as catalogId from ref_catalog_data a,catalog_id b where a.city=b.city and a.state =b.stateOrProvince and a.wire_center=b.wirecenter"
  },
  {
    "ruleID":"262",
    "ruleType":"addColumns",
    "dataFrameID":"HSI_Prod_Att_COS_HSI_CAT",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Adding a new column for catalog.action with ADD",
    "ruleCategory":"TG",
    "ruleText":"HSI_Prod_Att_COS_HSI_CAT,action,'ADD'"
  },
  {
    "ruleID":"263",
    "ruleType":"addColumns",
    "dataFrameID":"HSI_Prod_Att_COS_HSI_CAT",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Adding a new column for catalog.contractTerm with 0",
    "ruleCategory":"TG",
    "ruleText":"HSI_Prod_Att_COS_HSI_CAT,contractTerm,'0'"
  },
  {
    "ruleID":"265",
    "ruleType":"executeSQLQuery",
    "dataFrameID":"HSI_Prod_Att_COS_HSI_OFF",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Adding a new column for offer details ",
    "ruleCategory":"TG",
	//"debugInfo": "rows",
    "ruleText":"select distinct p_key.BAN,BLG_ACCT_TEL_NO,nvl(OTC,0) as discountedOtc, (NVL(RC,0)-NVL(discountRate,0)) as discountedRc,nvl(OFFER_CATEGORY,' ') as offerCategory,nvl(OTC,0) as otc,nvl(PRODUCT_OFFER_ID,'') as productOfferingId,nvl(RC,0) as rc,nvl(OFFER_NAME, '') as offerName,nvl(offerType, '') offerType from (select aa.BAN,aa.BLG_ACCT_TEL_NO, BM_PRODUCT_ID, BM_PRODUCT_NAME, CATALOG_SPEC_ID, CATALOG_CODE, PRODUCT_OFFER_ID, OFFER_NAME,(CASE WHEN (IS_PRICE_FOR_LIFE = 'YES') THEN 'P4L' WHEN (IS_PRICE_FOR_LIFE = 'NO' AND UPPER(OFFER_TYPE) = 'STANDALONE-NON BUNDLE') THEN 'NON_BUNDLE' WHEN (IS_PRICE_FOR_LIFE = 'NO' AND UPPER(OFFER_TYPE) = 'NON STANDALONE-NON BUNDLE') THEN 'NON_BUNDLE' WHEN (IS_PRICE_FOR_LIFE = 'NO' AND UPPER(OFFER_TYPE) = 'STANDALONE-BUNDLE') THEN 'BUNDLE'    WHEN (IS_PRICE_FOR_LIFE = 'NO' AND UPPER(OFFER_TYPE) = 'NON STANDALONE-BUNDLE') THEN 'BUNDLE' END) offerType, OFFER_CATEGORY,PriceKey_comp , CONCAT(CATALOG_SPEC_ID, '~', CATALOG_CODE, '~', PRODUCT_OFFER_ID, '~',PriceKey_comp) as priceKey  from stg_account_address aa inner join ref_catalog_data cd on cd.state = aa.stateOrProvince and cd.city = aa.city and cd.WIRE_CENTER = aa.wirecenter  inner join (select tech.BAN,tech.BLG_ACCT_TEL_NO, BM_PRODUCT_ID, BM_PRODUCT_NAME, RFSID, PRODUCT, PriceKey_comp from ref_usoc_rfsid_bmprod urb inner join (select distinct a.BAN,a.BLG_ACCT_TEL_NO,FEATURE_CODE from BMCONV_FUTURECODE a ) tech  on urb.USOC_VAL = tech.FEATURE_CODE where UPPER(urb.BM_PRODUCT_NAME) != 'MODEM' and UPPER(urb.BM_PRODUCT_NAME) != 'CENTURYLINK @ EASE') HSI_Products on aa.BAN = HSI_Products.BAN  left join ref_bm_offer_data bod on bod.OFFER_COMPONENT = HSI_Products.BM_PRODUCT_NAME and bod.ban=HSI_Products.ban) p_key left join (select A.BAN,A.PRICETYPE,A.RC RC,B.discountRate discountRate,0 as OTC,A.PRICEDESCRIPTION from (SELECT A.BAN,A.PRICETYPE,A.PRICEDESCRIPTION,A.RC RC FROM ENS_PRICE A where SUB_CONTAINER_TYPE in('CORE') AND UPPER(FEATURE_DESC) not like '%EMAIL%' and (UPPER(trim(FEATURE_CODE)) like '%A' or UPPER(trim(FEATURE_CODE)) in ('JA2351','JA2352','JA2353') )) A left join  (Select ban,sum(discountRate) discountRate from DISCOUNT_QUERY_EXT where discount_CATEORY=0 and discount_CATEORY_EASE=0 group by ban) B on A.BAN = B.BAN) P_BOOK on p_key.BAN=p_BOOK.BAN "
  },
  {
    "ruleID":"266",
    "ruleType":"addColumns",
    "dataFrameID":"HSI_Prod_Att_COS_HSI_OFF",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Adding a new column offer.offerSubType with REGULAR",
    "ruleCategory":"TG",
    "ruleText":"HSI_Prod_Att_COS_HSI_OFF,offerSubType,'REGULAR'"
  },
  {
    "ruleID":"267",
    "ruleType":"addColumns",
    "dataFrameID":"HSI_Prod_Att_COS_HSI_OFF",
    "persist":"N",
    "ruleStatus":"off",
    "ruleDescription":"Adding a new column offer.offerType with P4L",
    "ruleCategory":"TG",
    "ruleText":"HSI_Prod_Att_COS_HSI_OFF,offerType,'P4L'"
  },
  {
    "ruleID":"268",
    "ruleType":"addColumns",
    "dataFrameID":"HSI_Prod_Att_COS_HSI_OFF",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Adding a new column offer.quantity with 1",
    "ruleCategory":"TG",
    "ruleText":"HSI_Prod_Att_COS_HSI_OFF,quantity,1"
  },
  {
    "ruleID":"269",
    "ruleType":"addColumns",
    "dataFrameID":"HSI_Prod_Att_COS_HSI_OFF",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Adding a new column offer.contractStartDate with current_timeshamp()",
    "ruleCategory":"TG",
    "ruleText":"HSI_Prod_Att_COS_HSI_OFF,contractStartDate,current_timestamp()"
  },
  {
    "ruleID":"270",
    "ruleType":"joinTables",
    "dataFrameID":"HSI_Prod_Att_COS_HSI_CAT_SUB",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Join tables for HSI_Prod_Att_COS_HSI_CAT and HSI_MODEM_COS_EASE ",
    "ruleText":"HSI_Prod_Att_COS_HSI_CAT,BAN,HSI_MODEM_COS_EASE,BAN",
    "ruleCategory":"TG",
    "joinType":"inner",
   // "debugInfo": "rows",
    "renameKeys":"Y"
  },
  {
    "ruleID":"271",
    "ruleType":"joinTables",
    "dataFrameID":"HSI_Prod_Att_COS_HSI_CAT_SUB_OFF",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Join tables for HSI_Prod_Att_COS_HSI_CAT_SUB and HSI_Prod_Att_COS_HSI_OFF",
    "ruleText":"HSI_Prod_Att_COS_HSI_CAT_SUB,BAN,HSI_Prod_Att_COS_HSI_OFF,BAN",
    "ruleCategory":"TG",
    "joinType":"left",
   // "debugInfo": "rows",
    "renameKeys":"Y"
  },
   {
    "ruleID":"272",
    "ruleType":"getStructColumn",
    "dataFrameID":"HSI_Prod_Att_COS_HSI_COI",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a Structure for customerOrderItems",
    "ruleCategory":"TG",
  //  "debugInfo":"rows",
    "ruleText":"HSI_Prod_Att_COS_HSI_CAT_SUB_OFF,customerOrderItems,action,catalogId,contractTerm,customerOrderSubItems,discountedOtc,discountedRc,offerCategory,offerSubType,offerType,otc,productOfferingId,quantity,rc,contractStartDate,offerName"
  },
  {
    "ruleID":"273",
    "ruleType":"getFrozenList",
    "dataFrameID":"HSI_Prod_Att_COS_HSI_COI",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a Array structure For HSI_Prod_Att_COS_HSI_COI",
    "ruleCategory":"TG",
    "ruleText":"HSI_Prod_Att_COS_HSI_COI,customerOrderItems,customerOrderItems",
    "keyColumns":"BAN"
  },
  {
    "ruleID":"274",
    "ruleType":"joinTables",
    "dataFrameID":"CDS_BMCONV_ACCOUNT_CASE2",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Join tables for CDS_BMCONV_ACCOUNT_CASE2 and HSI_Prod_Att_COS_HSI_COI",
    "ruleText":"CDS_BMCONV_ACCOUNT_CASE2,BAN,HSI_Prod_Att_COS_HSI_COI,BAN",
    "ruleCategory":"TG",
    "joinType":"inner",
 //   "debugInfo":"rows",
    "renameKeys":"Y"
  },
   {
    "ruleID":"275",
    "ruleType":"executeSQLQuery",
    "dataFrameID":"BMCONV_ACCOUNT_STG_2",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Adding a new column orderDocument.availableServices.networkInfrastructureIndicatorCode",
    "ruleCategory":"TG",
 	 //  "debugInfo":"rows",
    "ruleText":"SELECT DISTINCT A.BLG_ACCT_TEL_NO,networkInfrastructureIndCd as networkInfrastructureIndicatorCode, (CASE When TECHNOLOGY = '' then 'VDSL2' Else TECHNOLOGY END) as accessType FROM BMCONV_FUTURECODE A,ref_usoc_rfsid_bmprod B WHERE A.FEATURE_CODE = B.USOC_VAL  and  upper(B.BM_PRODUCT_NAME) not in ('MODEM' ,'CENTURYLINK @ EASE')"
  },
  {
    "ruleID":"276",
    "ruleType":"addColumns",
    "dataFrameID":"BMCONV_ACCOUNT_STG_2",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Adding a new column orderDocument.availableServices.serviceCategory",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_STG_2,serviceCategory,'DATA'"
  },
  {
    "ruleID":"277",
    "ruleType":"addColumns",
    "dataFrameID":"BMCONV_ACCOUNT_STG_2",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Adding a new column orderDocument.availableServices.qualificationColorName",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_STG_2,qualificationColorName,'GREEN'"
  },
  {
    "ruleID":"278",
    "ruleType":"addColumns",
    "dataFrameID":"BMCONV_ACCOUNT_STG_2",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Adding a new column orderDocument.availableServices.offerCategory",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_STG_2,offerCategory,'INTERNET'"
  },
  {
    "ruleID":"279",
    "ruleType":"addColumns",
    "dataFrameID":"BMCONV_ACCOUNT_STG_2",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Adding a new column orderDocument.availableServices.processInfo",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_STG_2,processInfo,array()"
  },
  {
    "ruleID":"280",
    "ruleType":"getStructColumn",
    "dataFrameID":"BMCONV_ACCOUNT_STG_2",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Generate a structure column available services",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_STG_2,availableService,accessType,serviceCategory,networkInfrastructureIndicatorCode,qualificationColorName,offerCategory,processInfo"
  },
  {
    "ruleID":"281",
    "ruleType":"getFrozenList",
    "dataFrameID":"BMCONV_ACCOUNT_STG_2",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Generate a Array structure column available services",
    "ruleCategory":"TG",
 	// //  "debugInfo":"rows",
    "ruleText":"BMCONV_ACCOUNT_STG_2,availableServices,availableService",
    "keyColumns":"BLG_ACCT_TEL_NO"
  },
   {
    "ruleID":"282",
    "ruleType":"addColumns",
    "dataFrameID":"BMCONV_ACCOUNT_STG_3",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Adding a new column orderDocument.reservedTN.tnType",
    "ruleCategory":"TG",
	//  "debugInfo":"rows",
    "ruleText":"BMCONV_ACCOUNT,tnType,'DEFAULTED'"
  },
  {
    "ruleID":"283",
    "ruleType":"addColumns",
    "dataFrameID":"BMCONV_ACCOUNT_STG_3",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Adding a new column orderDocument.reservedTN.workingTN",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_STG_3,workingTN,'NO'"
  },
  {
    "ruleID":"284",
    "ruleType":"addColumns",
    "dataFrameID":"BMCONV_ACCOUNT_STG_3",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Adding a new column orderDocument.reservedTN.productType",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_STG_3,productType,'INTERNET'"
  },
  {
    "ruleID":"285",
    "ruleType":"copyColumn",
    "dataFrameID":"BMCONV_ACCOUNT_STG_3",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Copy a column for orderDocument.reservedTN.requestedTelephoneNumber",
    "ruleCategory":"TG",
    "ruleText":"requestedTelephoneNumber,BLG_ACCT_TEL_NO"
  },
  {
    "ruleID":"286",
    "ruleType":"getStructColumn",
    "dataFrameID":"BMCONV_ACCOUNT_STG_3",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a Structure for orderDocument.reservedTN",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_STG_3,reserved_TN,requestedTelephoneNumber,tnType,workingTN,productType"
  },
  {
    "ruleID":"287",
    "ruleType":"getFrozenList",
    "dataFrameID":"BMCONV_ACCOUNT_STG_3",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a Array structure for orderDocument.reservedTN",
    "ruleCategory":"TG",
   //  "debugInfo":"rows",
    "ruleText":"BMCONV_ACCOUNT_STG_3,reservedTN,reserved_TN",
    "keyColumns":"BLG_ACCT_TEL_NO"
  },
  {
    "ruleID":"288",
    "ruleType":"joinTables",
    "dataFrameID":"BMCONV_ACCOUNT_STG_23_JOIN",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Joining 2 Staging Tables BMCONV_ACCOUNT_STG_2 and BMCONV_ACCOUNT_STG_3",
    "ruleCategory":"TG",
    "joinType":"inner",
    "renameKeys":"Y",
 	 //  "debugInfo":"rows",
    "ruleText":"BMCONV_ACCOUNT_STG_2,BLG_ACCT_TEL_NO,BMCONV_ACCOUNT_STG_3,BLG_ACCT_TEL_NO"
  },
  {
    "ruleID":"289",
    "ruleType":"addColumns",
    "dataFrameID":"BMCONV_ACCOUNT_STG_23_JOIN",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Added new column for orderDocument.existingServiceAddress",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_STG_23_JOIN,existingServiceAddress,array()"
  },
  {
    "ruleID":"291",
    "ruleType":"addColumns",
    "dataFrameID":"BMCONV_ACCOUNT_STG_23_JOIN",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Added new col for orderDocument.productConfiguration",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_STG_23_JOIN,productConfiguration,array()"
  },
  {
    "ruleID":"292",
    "ruleType":"addColumns",
    "dataFrameID":"BMCONV_ACCOUNT_STG_23_JOIN",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Added new col for orderDocument.existingProductConfiguration",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_STG_23_JOIN,existingProductConfiguration,array()"
  },
   {
    "ruleID":"293",
    "ruleType":"executeSQLQuery",
    "dataFrameID":"BMCONV_ACCOUNT_FIDS_STG_1",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Getting the First and last name from BMCONV_ACCOUNT_FIDS1",
    "ruleCategory":"TG",
 	// //  "debugInfo":"rows",
    "ruleText":"Select BLG_ACCT_TEL_NO,First_name firstName, LAST_NAME lastName from BMCONV_ACCOUNT_FIDS1"
  },
   {
    "ruleID":"294",
    "ruleType":"addColumns",
    "dataFrameID":"BMCONV_ACCOUNT_FIDS_STG_1",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Adding a new col for orderDocument.accountInfo.accountName.middleName",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_FIDS_STG_1,middleName,''"
  },
  {
    "ruleID":"295",
    "ruleType":"addColumns",
    "dataFrameID":"BMCONV_ACCOUNT_FIDS_STG_1",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Adding a new col for orderDocument.accountInfo.accountName.title",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_FIDS_STG_1,title,''"
  },
  {
    "ruleID":"296",
    "ruleType":"getStructColumn",
    "dataFrameID":"BMCONV_ACCOUNT_FIDS_STG_1",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a Structure for accountName",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_FIDS_STG_1,accountName,firstName,lastName,middleName,title"
  },
  {
    "ruleID":"297",
    "ruleType":"addColumns",
    "dataFrameID":"BMCONV_ACCOUNT_FIDS_STG_AIAPEM",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Adding a new col for orderDocument.accountInfo.accountPreferences.emailNotification.billingNotification",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT,billingNotification,true"
  },
  {
    "ruleID":"298",
    "ruleType":"addColumns",
    "dataFrameID":"BMCONV_ACCOUNT_FIDS_STG_AIAPEM",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Adding a new col for orderDocument.accountInfo.accountPreferences.emailNotification.orderingNotification",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_FIDS_STG_AIAPEM,orderingNotification,true"
  },
  {
    "ruleID":"299",
    "ruleType":"addColumns",
    "dataFrameID":"BMCONV_ACCOUNT_FIDS_STG_AIAPEM",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Adding a new col for orderDocument.accountInfo.accountPreferences.emailNotification.repairNotification",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_FIDS_STG_AIAPEM,repairNotification,true"
  },
  {
    "ruleID":"300",
    "ruleType":"getStructColumn",
    "dataFrameID":"BMCONV_ACCOUNT_FIDS_STG_AIAPEM",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a Structure for  emailNotification",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_FIDS_STG_AIAPEM,emailNotification,billingNotification,orderingNotification,repairNotification"
  },
  {
    "ruleID":"301",
    "ruleType":"addColumns",
    "dataFrameID":"BMCONV_ACCOUNT_FIDS_STG_AIAPTN",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Adding a new column  orderDocument.accountInfo.accountPreferences.textNotification.billingNotification",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT,billingNotification,true"
  },
  {
    "ruleID":"302",
    "ruleType":"addColumns",
    "dataFrameID":"BMCONV_ACCOUNT_FIDS_STG_AIAPTN",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Adding a new column  orderDocument.accountInfo.accountPreferences.textNotification.orderingNotification",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_FIDS_STG_AIAPTN,orderingNotification,true"
  },
  {
    "ruleID":"303",
    "ruleType":"addColumns",
    "dataFrameID":"BMCONV_ACCOUNT_FIDS_STG_AIAPTN",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Adding a new column  orderDocument.accountInfo.accountPreferences.textNotification.repairNotification",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_FIDS_STG_AIAPTN,repairNotification,true"
  },
  {
    "ruleID":"304",
    "ruleType":"getStructColumn",
    "dataFrameID":"BMCONV_ACCOUNT_FIDS_STG_AIAPTN",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a Structure for orderDocument.accountInfo.accountPreferences.textNotification.repairNotification",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_FIDS_STG_AIAPTN,textNotification,billingNotification,orderingNotification,repairNotification"
  },
  {
    "ruleID":"305",
    "ruleType":"joinTables",
    "dataFrameID":"BMCONV_ACCOUNT_FIDS_STG_AIAP",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Joining BMCONV_ACCOUNT_FIDS_STG_AIAPEM and BMCONV_ACCOUNT_FIDS_STG_AIAPTN",
    "ruleCategory":"TG",
    "joinType":"inner",
    "renameKeys":"Y",
    // //  "debugInfo":"rows",
    "ruleText":"BMCONV_ACCOUNT_FIDS_STG_AIAPEM,BLG_ACCT_TEL_NO,BMCONV_ACCOUNT_FIDS_STG_AIAPTN,BLG_ACCT_TEL_NO"
  },
   {
    "ruleID":"307",
    "ruleType":"addColumns",
    "dataFrameID":"BMCONV_ACCOUNT_FIDS_STG_AIAP",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Added a col orderDocument.accountInfo.accountPreferences.paperlessBilling",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_FIDS_STG_AIAP,paperlessBilling,true"
  },
  {
    "ruleID":"308",
    "ruleType":"addColumns",
    "dataFrameID":"BMCONV_ACCOUNT_FIDS_STG_AIAP",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Added a col orderDocument.accountInfo.accountPreferences.spanishBillPrint",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_FIDS_STG_AIAP,spanishBillPrint,false"
  },
  {
    "ruleID":"309",
    "ruleType":"addColumns",
    "dataFrameID":"BMCONV_ACCOUNT_FIDS_STG_AIAP",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Added a col orderDocument.accountInfo.accountPreferences.noTeleMarketing",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_FIDS_STG_AIAP,noTeleMarketing,false"
  },
  {
    "ruleID":"310",
    "ruleType":"addColumns",
    "dataFrameID":"BMCONV_ACCOUNT_FIDS_STG_AIAP",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Added a col orderDocument.accountInfo.accountPreferences.noEmail",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_FIDS_STG_AIAP,noEmail,false"
  },
  {
    "ruleID":"311",
    "ruleType":"addColumns",
    "dataFrameID":"BMCONV_ACCOUNT_FIDS_STG_AIAP",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Added a col orderDocument.accountInfo.accountPreferences.noDirectMail",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_FIDS_STG_AIAP,noDirectMail,false"
  },
  {
    "ruleID":"312",
    "ruleType":"addColumns",
    "dataFrameID":"BMCONV_ACCOUNT_FIDS_STG_AIAP",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Added a col orderDocument.accountInfo.accountPreferences.braille",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_FIDS_STG_AIAP,braille,false"
  },
  {
    "ruleID":"313",
    "ruleType":"addColumns",
    "dataFrameID":"BMCONV_ACCOUNT_FIDS_STG_AIAP",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Added a col orderDocument.accountInfo.accountPreferences.largePrint",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_FIDS_STG_AIAP,largePrint,false"
  },
  {
    "ruleID":"314",
    "ruleType":"getStructColumn",
    "dataFrameID":"BMCONV_ACCOUNT_FIDS_STG_AIAP",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a Structure for orderDocument.accountInfo.accountPreferences",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_FIDS_STG_AIAP,accountPreferences,paperlessBilling,spanishBillPrint,noTeleMarketing,noEmail,noDirectMail,braille,largePrint,emailNotification,textNotification"
  },
  {
    "ruleID":"315",
    "ruleType":"executeSQLQuery",
    "dataFrameID":"BMCONV_ACCOUNT_FIDS_STG_AICO_1",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"To Get the Contact Number",
    "ruleCategory":"TG",
 	// //  "debugInfo":"rows",
    "ruleText":"select distinct BLG_ACCT_TEL_NO, contactNumber from BMCONV_ACCOUNT_FIDS1"
  },
  {
    "ruleID":"316",
    "ruleType":"executeSQLQuery",
    "dataFrameID":"BMCONV_ACCOUNT_FIDS_STG_AICO_2",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"To Get the email",
    "ruleCategory":"TG",
 	// //  "debugInfo":"rows",
    "ruleText":"select distinct BLG_ACCT_TEL_NO, emailAddress from BMCONV_ACCOUNT_FIDS1"
  },
  {
    "ruleID":"317",
    "ruleType":"joinTables",
    "dataFrameID":"BMCONV_ACCOUNT_FIDS_STG_AICO",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Joining for BMCONV_ACCOUNT_FIDS_STG_AICO",
    "ruleCategory":"TG",
    "joinType":"inner",
    "renameKeys":"Y",
   // //  "debugInfo":"rows",
    "ruleText":"BMCONV_ACCOUNT_FIDS_STG_AICO_1,BLG_ACCT_TEL_NO,BMCONV_ACCOUNT_FIDS_STG_AICO_2,BLG_ACCT_TEL_NO"
  },
   {
    "ruleID":"318",
    "ruleType":"addColumns",
    "dataFrameID":"BMCONV_ACCOUNT_FIDS_STG_AICO",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Added new Column for orderDocument.accountInfo.contact.smsNumber",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_FIDS_STG_AICO,smsNumber,''"
  },
  {
    "ruleID":"319",
    "ruleType":"addColumns",
    "dataFrameID":"BMCONV_ACCOUNT_FIDS_STG_AICO",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Added new Column for orderDocument.accountInfo.contact.emailAddrDeclined",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_FIDS_STG_AICO,emailAddrDeclined,false"
  },
  {
    "ruleID":"320",
    "ruleType":"getStructColumn",
    "dataFrameID":"BMCONV_ACCOUNT_FIDS_STG_AICO",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a Structure for orderDocument.accountInfo.contact",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_FIDS_STG_AICO,contact,contactNumber,smsNumber,emailAddress,emailAddrDeclined"
  },
  {
    "ruleID":"321",
    "ruleType":"addColumns",
    "dataFrameID":"BMCONV_ACCOUNT_FIDS_STG_AIPD",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Added new column for orderDocument.accountInfo.personalDetails.underAgeAck",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT,underAgeAck,false"
  },
  {
    "ruleID":"322",
    "ruleType":"getStructColumn",
    "dataFrameID":"BMCONV_ACCOUNT_FIDS_STG_AIPD",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a Structure for orderDocument.accountInfo.personalDetails",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_FIDS_STG_AIPD,personalDetails,underAgeAck"
  },
  {
    "ruleID":"323",
    "ruleType":"joinTables",
    "dataFrameID":"BMCONV_ACCOUNT_FIDS_STG_AIJ_1",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Joining BMCONV_ACCOUNT_FIDS_STG_1 and BMCONV_ACCOUNT_FIDS_STG_AIAP",
    "ruleCategory":"TG",
    "joinType":"inner",
    "renameKeys":"Y",
     // //  "debugInfo":"rows",
    "ruleText":"BMCONV_ACCOUNT_FIDS_STG_1,BLG_ACCT_TEL_NO,BMCONV_ACCOUNT_FIDS_STG_AIAP,BLG_ACCT_TEL_NO"
  },
  {
    "ruleID":"324",
    "ruleType":"joinTables",
    "dataFrameID":"BMCONV_ACCOUNT_FIDS_STG_AIJ_2",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Joining BMCONV_ACCOUNT_FIDS_STG_AIJ_1and BMCONV_ACCOUNT_FIDS_STG_AICO",
    "ruleCategory":"TG",
    "joinType":"inner",
    "renameKeys":"Y",
   // //  "debugInfo":"rows",
    "ruleText":"BMCONV_ACCOUNT_FIDS_STG_AICO,BLG_ACCT_TEL_NO,BMCONV_ACCOUNT_FIDS_STG_AIJ_1,BLG_ACCT_TEL_NO"
  },
  {
    "ruleID":"325",
    "ruleType":"joinTables",
    "dataFrameID":"BMCONV_ACCOUNT_FIDS_STG_AIJOIN",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Joining BMCONV_ACCOUNT_FIDS_STG_AIJ_2and BMCONV_ACCOUNT_FIDS_STG_AIPD",
    "ruleCategory":"TG",
    "joinType":"inner",
    "renameKeys":"Y",
 //  "debugInfo":"count",
    "ruleText":"BMCONV_ACCOUNT_FIDS_STG_AIPD,BLG_ACCT_TEL_NO,BMCONV_ACCOUNT_FIDS_STG_AIJ_2,BLG_ACCT_TEL_NO"
  },
{
    "ruleID":"327",
    "ruleType":"addColumns",
    "dataFrameID":"BMCONV_ACCOUNT_FIDS_STG_AIJOIN",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Added new column for orderDocument.accountInfo.isBillAddrSameAsServiceAddress",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_FIDS_STG_AIJOIN,isBillAddrSameAsServiceAddress,true"
  },
   {
    "ruleID":"328",
    "ruleType":"addColumns",
    "dataFrameID":"BMCONV_ACCOUNT_FIDS_STG_AIJOIN",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Added new column for orderDocument.accountInfo.accountPin",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_FIDS_STG_AIJOIN,accountPin,''"
  },
  {
    "ruleID":"329",
    "ruleType":"addColumns",
    "dataFrameID":"BMCONV_ACCOUNT_FIDS_STG_AIJOIN",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Added new column for orderDocument.accountInfo.accountSubType",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_FIDS_STG_AIJOIN,accountSubType,'R'"
  },
  {
    "ruleID":"330",
    "ruleType":"addColumns",
    "dataFrameID":"BMCONV_ACCOUNT_FIDS_STG_AIJOIN",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Added new column for orderDocument.accountInfo.accountType",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_FIDS_STG_AIJOIN,accountType,'I'"
  },
  {
    "ruleID":"331",
    "ruleType":"addColumns",
    "dataFrameID":"BMCONV_ACCOUNT_FIDS_STG_AIJOIN",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Adding a new column orderDocument.accountInfo.billingType",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_FIDS_STG_AIJOIN,billingType,'POSTPAID'"
  },
  {
    "ruleID":"332",
    "ruleType":"addColumns",
    "dataFrameID":"BMCONV_ACCOUNT_FIDS_STG_AIJOIN",
    "persist":"N",
    "ruleStatus":"off",
    "ruleDescription":"Adding a new column orderDocument.accountInfo.billCycle",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_FIDS_STG_AIJOIN,billCycle,'0'"
  },
    {
    "ruleID":"3320",
    "ruleType":"dropColumns",
    "dataFrameID":"BMCONV_ACCOUNT_FIDS_STG_AIJOIN",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Removing Duplicate billCycle column",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_FIDS_STG_AIJOIN,billCycle"
  },
    {
    "ruleID":"332",
    "ruleType":"executeSQLQuery",
    "dataFrameID":"BMCONV_ACCOUNT_FIDS_STG_AIJOIN",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"To get billcycle",
    "ruleCategory":"TG",
	//"debugInfo":"rows",
    "ruleText":"select A.*,billcycle from BMCONV_ACCOUNT_FIDS_STG_AIJOIN A, BMCONV_BILL_CYCLE B where A.BLG_ACCT_TEL_NO=B.BLG_ACCT_TEL_NO"
  },
  {
    "ruleID":"333",
    "ruleType":"addColumns",
    "dataFrameID":"BMCONV_ACCOUNT_FIDS_STG_AIJOIN",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Adding a new column orderDocument.accountInfo.creditClass",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_FIDS_STG_AIJOIN,creditClass,''"
  },
  {
    "ruleID":"334",
    "ruleType":"addColumns",
    "dataFrameID":"BMCONV_ACCOUNT_FIDS_STG_AIJOIN",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Adding a new column orderDocument.accountInfo.billingAdditionalInfo",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_FIDS_STG_AIJOIN,billingAdditionalInfo,''"
  },
  {
    "ruleID":"335",
    "ruleType":"addColumns",
    "dataFrameID":"BMCONV_ACCOUNT_FIDS_STG_AIJOIN",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Adding a new column orderDocument.accountInfo.billingAddressType",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_FIDS_STG_AIJOIN,billingAddressType,'S'"
  },
  {
    "ruleID":"336",
    "ruleType":"copyColumn",
    "dataFrameID":"CDS_BMCONV_ACCOUNT_CASE2",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Adding a new column orderDocument.accountInfo.ban",
    "ruleCategory":"TG",
	//"debugInfo":"rows",
    "ruleText":"ban,bann"
  },
  {
    "ruleID":"338",
    "ruleType":"selectColumns",
    "dataFrameID":"RAMA_ID",
    "persist":"N",
    "ruleStatus":"on",
    "ruleCategory":"TG",
   // // //  "debugInfo":"rows",
    "ruleText":"CDS_BMCONV_ACCOUNT_CASE2,BLG_ACCT_TEL_NO,BAN",
	"ruleDescription":"Select required columns to add ban to accountInfo"
  },
  {
    "ruleID":"339",
    "ruleType":"joinTables",
    "dataFrameID":"BMCONV_ACCOUNT_FIDS_STG_AIJOIN",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Join Tables to bring BAN into accountInfo",
    "ruleCategory":"TG",
    "joinType":"inner",
    "renameKeys":"N",
  //"debugInfo":"rows",
    "ruleText":"BMCONV_ACCOUNT_FIDS_STG_AIJOIN,BLG_ACCT_TEL_NO,RAMA_ID,BLG_ACCT_TEL_NO"
  },
 {
    "ruleID":"340",
    "ruleType":"getStructColumn",
    "dataFrameID":"BMCONV_ACCOUNT_FIDS_STG_AIJOIN",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a Structure for accountInfo",
    "ruleCategory":"TG",
	// //  "debugInfo":"rows",
    "ruleText":"BMCONV_ACCOUNT_FIDS_STG_AIJOIN,accountInfo,isBillAddrSameAsServiceAddress,accountName,accountPin,accountSubType,accountType,accountPreferences,ban,billingType,billCycle,contact,creditClass,personalDetails,billingAdditionalInfo,billingAddressType"
  },
  {
    "ruleID":"341",
    "ruleType":"addColumns",
    "dataFrameID":"BMCONV_ACCOUNT_STG_CRCI",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Added new col for orderDocument.creditReview.creditInfo.finalBillInfo",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT,finalBillInfo,array()"
  },
  {
    "ruleID":"342",
    "ruleType":"addColumns",
    "dataFrameID":"BMCONV_ACCOUNT_STG_CRCI",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Added new col for orderDocument.creditReview.creditInfo.creditClass",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_STG_CRCI,creditClass,''"
  },
  {
    "ruleID":"343",
    "ruleType":"addColumns",
    "dataFrameID":"BMCONV_ACCOUNT_STG_CRCI",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Added new col for orderDocument.creditReview.creditInfo.finalBillInd",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_STG_CRCI,finalBillInd,false"
  },
  {
    "ruleID":"344",
    "ruleType":"getStructColumn",
    "dataFrameID":"BMCONV_ACCOUNT_STG_CRCI",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a Structure for orderDocument.creditReview.creditInfo",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_STG_CRCI,creditInfo,finalBillInfo,creditClass,finalBillInd"
  },
  {
    "ruleID":"345",
    "ruleType":"addColumns",
    "dataFrameID":"BMCONV_ACCOUNT_STG_CRDI",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Adding a new column  orderDocument.creditReview.depositInfo.depositRequired",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT,depositRequired,false"
  },
  {
    "ruleID":"346",
    "ruleType":"addColumns",
    "dataFrameID":"BMCONV_ACCOUNT_STG_CRDI",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Adding a new column  orderDocument.creditReview.depositInfo.products",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_STG_CRDI,products,array()"
  },
  {
    "ruleID":"347",
    "ruleType":"getStructColumn",
    "dataFrameID":"BMCONV_ACCOUNT_STG_CRDI",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a Structure for orderDocument.creditReview.depositInfo",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_STG_CRDI,depositInfo,depositRequired,products"
  },
  {
    "ruleID":"348",
    "ruleType":"addColumns",
    "dataFrameID":"BMCONV_ACCOUNT_STG_CRBE",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Adding a new column orderDocument.creditReview.billEstimate.quote",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT,quote,array()"
  },
  {
    "ruleID":"349",
    "ruleType":"getStructColumn",
    "dataFrameID":"BMCONV_ACCOUNT_STG_CRBE",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a Structure for orderDocument.creditReview.billEstimate",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_STG_CRBE,billEstimate,quote"
  },
  {
    "ruleID":"350",
    "ruleType":"joinTables",
    "dataFrameID":"BMCONV_ACCOUNT_STG_CRCIDI",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Joining BMCONV_ACCOUNT_STG_CRCI and BMCONV_ACCOUNT_STG_CRDI",
    "ruleCategory":"TG",
    "joinType":"inner",
    "renameKeys":"Y",
   // //  "debugInfo":"rows",
    "ruleText":"BMCONV_ACCOUNT_STG_CRCI,BLG_ACCT_TEL_NO,BMCONV_ACCOUNT_STG_CRDI,BLG_ACCT_TEL_NO"
  },
    {
    "ruleID":"351",
    "ruleType":"joinTables",
    "dataFrameID":"BMCONV_ACCOUNT_STG_CRCIDIBE",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Joining BMCONV_ACCOUNT_STG_CRCIDI and BMCONV_ACCOUNT_STG_CRBE",
    "ruleCategory":"TG",
    "joinType":"inner",
    "renameKeys":"Y",
   // //  "debugInfo":"rows",
    "ruleText":"BMCONV_ACCOUNT_STG_CRCIDI,BLG_ACCT_TEL_NO,BMCONV_ACCOUNT_STG_CRBE,BLG_ACCT_TEL_NO"
  },
  {
    "ruleID":"352",
    "ruleType":"dropColumns",
    "dataFrameID":"BMCONV_ACCOUNT_STG_CRCIDIBE",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Removing the columns from BMCONV_ACCOUNT_STG_CRCIDIBE",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_STG_CRCIDIBE,DPC_CD,BLG_ACCT_CUS,CLASS_OF_SERVICE,ACCOUNT_ESTABLISHED_DAT,CONV_CYCLE_START_DAT,REGION_CD,MCN,EX_CD,CONVERSION_DAT"
  },
  {
    "ruleID":"353",
    "ruleType":"addColumns",
    "dataFrameID":"BMCONV_ACCOUNT_STG_CRCIDIBE",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Adding a new column orderDocument.creditReview.creditApplicationRefNumber",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_STG_CRCIDIBE,creditApplicationRefNumber,''"
  },
  {
    "ruleID":"354",
    "ruleType":"addColumns",
    "dataFrameID":"BMCONV_ACCOUNT_STG_CRCIDIBE",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Adding a new column orderDocument.creditReview.paymentInfo",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_STG_CRCIDIBE,paymentInfo,array()"
  },
  {
    "ruleID":"355",
    "ruleType":"getStructColumn",
    "dataFrameID":"BMCONV_ACCOUNT_STG_CRCIDIBE",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a Structure for orderDocument.creditReview",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_STG_CRCIDIBE,creditReview,creditInfo,creditApplicationRefNumber,depositInfo,paymentInfo,billEstimate"
  },
  {
    "ruleID":"356",
    "ruleType":"addColumns",
    "dataFrameID":"BMCONV_ACCOUNT_STG_SCDT",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Adding a new column orderDocument.schedule.dates.calculatedDueDate",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT,calculatedDueDate,regexp_replace(date_format(to_utc_timestamp(current_timestamp(),'PST'),'yyyy-MM-dd HH:mm:ss.SSS'),' ','T')||'Z' "
  },
  {
    "ruleID":"357",
    "ruleType":"addColumns",
    "dataFrameID":"BMCONV_ACCOUNT_STG_SCDT",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Adding a new column orderDocument.schedule.dates.finalDueDate",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_STG_SCDT,finalDueDate,regexp_replace(date_format(to_utc_timestamp(current_timestamp(),'PST'),'yyyy-MM-dd HH:mm:ss.SSS'),' ','T')||'Z'"
  },
  {
    "ruleID":"358",
    "ruleType":"addColumns",
    "dataFrameID":"BMCONV_ACCOUNT_STG_SCDT",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Adding a new column orderDocument.schedule.dates.overrideFlag",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_STG_SCDT,overrideFlag,false"
  },
  {
    "ruleID":"359",
    "ruleType":"addColumns",
    "dataFrameID":"BMCONV_ACCOUNT_STG_SCDT",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Adding a new column orderDocument.schedule.dates.isCRDAvailable",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_STG_SCDT,isCRDAvailable,true"
  },
  {
    "ruleID":"360",
    "ruleType":"getStructColumn",
    "dataFrameID":"BMCONV_ACCOUNT_STG_SCDT",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a Structure for orderDocument.schedule.dates",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_STG_SCDT,dates,calculatedDueDate,finalDueDate,overrideFlag,isCRDAvailable"
  },
  {
    "ruleID":"361",
    "ruleType":"addColumns",
    "dataFrameID":"BMCONV_ACCOUNT_STG_SCSH",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Added new col for orderDocument.schedule.shippingInfo.shippingAddress",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT,shippingAddress,null"
  },
  {
    "ruleID":"362",
    "ruleType":"addColumns",
    "dataFrameID":"BMCONV_ACCOUNT_STG_SCSH",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Added new col for orderDocument.schedule.shippingInfo.isShipAddrSameAsServiceAddress",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_STG_SCSH,isShipAddrSameAsServiceAddress,true"
  },
  {
    "ruleID":"363",
    "ruleType":"getStructColumn",
    "dataFrameID":"BMCONV_ACCOUNT_STG_SCSH",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a Structure for orderDocument.schedule.shippingInfo",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_STG_SCSH,shippingInfo,shippingAddress,isShipAddrSameAsServiceAddress"
  },
  {
    "ruleID":"364",
    "ruleType":"joinTables",
    "dataFrameID":"BMCONV_ACCOUNT_STG_SCDTSH",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"joining BMCONV_ACCOUNT_STG_SCDT  and BMCONV_ACCOUNT_STG_SCSH",
    "ruleCategory":"TG",
    "joinType":"inner",
    "renameKeys":"Y",
   // //  "debugInfo":"rows",
    "ruleText":"BMCONV_ACCOUNT_STG_SCDT,BLG_ACCT_TEL_NO,BMCONV_ACCOUNT_STG_SCSH,BLG_ACCT_TEL_NO"
  },
  {
    "ruleID":"365",
    "ruleType":"dropColumns",
    "dataFrameID":"BMCONV_ACCOUNT_STG_SCDTSH",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Removing the columns",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_STG_SCDTSH,DPC_CD,BLG_ACCT_CUS,CLASS_OF_SERVICE,ACCOUNT_ESTABLISHED_DAT,CONV_CYCLE_START_DAT,REGION_CD,MCN,EX_CD,CONVERSION_DAT"
  },
  {
    "ruleID":"369",
    "ruleType":"getStructColumn",
    "dataFrameID":"BMCONV_ACCOUNT_STG_SCDTSH",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a Structure for orderDocument.schedule",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_STG_SCDTSH,schedule,dates,shippingInfo"
  },
  {
    "ruleID":"370",
    "ruleType":"addColumns",
    "dataFrameID":"BMCONV_ACCOUNT_STG_AD",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Added new col for orderDocument.additionalInfo.chargeSummaryAck",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT,chargeSummaryAck,true"
  },
  {
    "ruleID":"371",
    "ruleType":"addColumns",
    "dataFrameID":"BMCONV_ACCOUNT_STG_AD",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Added new col for orderDocument.additionalInfo.disableOrderNotification",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_STG_AD,disableOrderNotification,false"
  },
  {
    "ruleID":"372",
    "ruleType":"getStructColumn",
    "dataFrameID":"BMCONV_ACCOUNT_STG_AD",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a Structure for orderDocument.additionalInfo",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_STG_AD,additionalInfo,chargeSummaryAck,disableOrderNotification"
  },
  {
    "ruleID":"373",
    "ruleType":"executeSQLQuery",
    "dataFrameID":"BMCONV_ACCOUNT_STG_FD1",
    "persist":"N",
    "ruleStatus":"off",
    "ruleDescription":"To get the SubMarket Code",
    "ruleCategory":"TG",
    "ruleText":"Select DISTINCT BLG_ACCT_TEL_NO ,BAN,SUB_MARKET_CODE as subMarketCode From BMCONV_ACCOUNT_SM"
  },
    {
    "ruleID":"373",
    "ruleType":"executeSQLQuery",
    "dataFrameID":"BMCONV_ACCOUNT_STG_FD1",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"To get the SubMarket Code",
    "ruleCategory":"TG",
//  "debugInfo":"rows",
    "ruleText":"Select DISTINCT a.BLG_ACCT_TEL_NO ,a.BAN,b.SUB_MARKET_CODE as subMarketCode From stg_account_address a,ref_sub_market b where a.city=b.CITY and a.stateOrProvince=b.STATE and a.wirecenter=b.WIRE_CENTER"
  },
  {
    "ruleID":"374",
    "ruleType":"executeSQLQuery",
    "dataFrameID":"BMCONV_ACCOUNT_STG_FD3",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"To Feature Code and Bundle Code, HSI Product Details",
    "ruleCategory":"TG",
   // //  "debugInfo":"rows",
    "ruleText":"Select DISTINCT BLG_ACCT_TEL_NO, BM_PRODUCT_ID,(CASE When BM_PRODUCT_NAME is null then 'LEGACY' Else BM_PRODUCT_NAME END) as bmProductName,FEATURE_CODE as featureCode,BUNDLE_CODE as bundleCode,PRODUCT_TYPE as productType,FEATURE_DESC as featureDescription,PRICE_PLAN as pricePlan, (CASE when (PRODUCT_TYPE ='WA'and BM_PRODUCT_NAME is null) Then 'false' when (PRODUCT_TYPE ='WA'and UPPER(BM_PRODUCT_NAME) ='MODEM' )Then 'false' Else'true' End) as isPrimary from (select tech.BAN, tech.BLG_ACCT_TEL_NO, BM_PRODUCT_ID, urb.BM_PRODUCT_NAME,tech.FEATURE_CODE,tech.BUNDLE_CODE,tech.PRODUCT_TYPE, tech.FEATURE_DESC,tech.PRICE_PLAN,urb.CART_PROD_ATTR_LIST_ID from ref_usoc_rfsid_bmprod urb Right join (SELECT FD.BAN,FD1.BLG_ACCT_TEL_NO,'LEGACY' as BM_PRODUCT_NAME, FEATURE_CODE,BUNDLE_CODE,PRODUCT_TYPE,FEATURE_DESC,PRICE_PLAN FROM BMCONV_FUTURECODE1 FD LEFT Join (Select BANN as BAN, BLG_ACCT_TEL_NO from CDS_BMCONV_ACCOUNT) FD1 on FD.BAN = FD1.BAN )tech on urb.USOC_VAL = tech.FEATURE_CODE)"
  },
  {
    "ruleID":"3740000",
    "ruleType":"executeSQLQuery",
    "dataFrameID":"BMCONV_ACCOUNT_STG_FD3_BC",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"To Feature Code and Bundle Code, HSI Product Details",
    "ruleCategory":"TG",
 //   "debugInfo":"rows",
    "ruleText":"Select DISTINCT BLG_ACCT_TEL_NO, BM_PRODUCT_ID,(CASE When BM_PRODUCT_NAME is null then 'LEGACY' Else BM_PRODUCT_NAME END) as bmProductName,FEATURE_CODE as featureCode,BUNDLE_CODE as bundleCode,PRODUCT_TYPE as productType,FEATURE_DESC as featureDescription,PRICE_PLAN as pricePlan, (CASE when (PRODUCT_TYPE ='WA'and BM_PRODUCT_NAME is null) Then 'false' when (PRODUCT_TYPE ='WA'and UPPER(BM_PRODUCT_NAME) ='MODEM') Then 'false' Else'true' End) as isPrimary from (select tech.BAN, tech.BLG_ACCT_TEL_NO, BM_PRODUCT_ID, urb.BM_PRODUCT_NAME,tech.FEATURE_CODE,tech.BUNDLE_CODE,tech.PRODUCT_TYPE, tech.FEATURE_DESC,tech.PRICE_PLAN,urb.CART_PROD_ATTR_LIST_ID from ref_usoc_rfsid_bmprod urb Right join (SELECT FD.BAN,FD1.BLG_ACCT_TEL_NO,BM_PRODUCT_NAME, FEATURE_CODE,BUNDLE_CODE,PRODUCT_TYPE,FEATURE_DESC,SUB_CONTAINER_TYPE,PRICE_PLAN from (SELECT FD.BAN,'LEGACY' as BM_PRODUCT_NAME, FEATURE_CODE,BUNDLE_CODE,PRODUCT_TYPE,FEATURE_DESC,SUB_CONTAINER_TYPE,PRICE_PLAN FROM BMCONV_FUTURECODE1 FD where ((SUB_CONTAINER_TYPE in('CORE') AND UPPER(FEATURE_DESC) not like '%EMAIL%' AND (UPPER(trim(FEATURE_CODE)) like '%A' or UPPER(trim(FEATURE_CODE)) in ('JA2351','JA2352','JA2353') )) OR (SUB_CONTAINER_TYPE IN ('EQP') and UPPER(FEATURE_DESC) like '%MODEM%') OR (SUB_CONTAINER_TYPE IN ('VAS') and UPPER(FEATURE_DESC) like '%AT EASE%') )) FD LEFT Join (Select BANN as BAN, BLG_ACCT_TEL_NO from CDS_BMCONV_ACCOUNT) FD1 on FD.BAN = FD1.BAN )tech on urb.USOC_VAL = tech.FEATURE_CODE)"
  },
  {
    "ruleID":"3741",
    "ruleType":"joinTables",
    "dataFrameID":"BMCONV_ACCOUNT_STG_FD",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"joining BMCONV_ACCOUNT_STG_FD1 and BMCONV_ACCOUNT_STG_FD3",
    "ruleCategory":"TG",
    "joinType":"inner",
    "renameKeys":"Y",
//    "debugInfo":"rows",
    "ruleText":"BMCONV_ACCOUNT_STG_FD1,BLG_ACCT_TEL_NO,BMCONV_ACCOUNT_STG_FD3,BLG_ACCT_TEL_NO"
  },
   {
    "ruleID":"3742",
    "ruleType":"addColumns",
    "dataFrameID":"BMCONV_ACCOUNT_STG_FD",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Adding a new column  orderDocument.featureDescription.ppfcs.ppEffectiveDate",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_STG_FD,ppEffectiveDate,current_timestamp()"
  },
   {
    "ruleID":"3743",
    "ruleType":"addColumns",
    "dataFrameID":"BMCONV_ACCOUNT_STG_FD",
    "persist":"N",
    "ruleStatus":"off",
    "ruleDescription":"Adding a new column  orderDocument.featureDescription.ppfcs.isPrimary",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_STG_FD,isPrimary,'true'"
  },
   {
    "ruleID":"3744",
    "ruleType":"addColumns",
    "dataFrameID":"BMCONV_ACCOUNT_STG_FD",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Adding a new column  orderDocument.featureDescription.ppfcs.recurTermFee",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_STG_FD,recurTermFee,'0'"
  },
   {
    "ruleID":"3745",
    "ruleType":"addColumns",
    "dataFrameID":"BMCONV_ACCOUNT_STG_FD",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Adding a new column  orderDocument.featureDescription.ppfcs.termFee",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_STG_FD,termFee,'0.00'"
  },
   {
    "ruleID":"3746",
    "ruleType":"addColumns",
    "dataFrameID":"BMCONV_ACCOUNT_STG_FD",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Adding a new column  orderDocument.featureDescription.ppfcs.action",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_STG_FD,action,'NI'"
  },
   {
    "ruleID":"3747",
    "ruleType":"addColumns",
    "dataFrameID":"BMCONV_ACCOUNT_STG_FD",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Adding a new column  orderDocument.featureDescription.ppfcs.term",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_STG_FD,term,'0'"
  },
   {
    "ruleID":"3748",
    "ruleType":"addColumns",
    "dataFrameID":"BMCONV_ACCOUNT_STG_FD",
    "persist":"N",
    "ruleStatus":"off",
    "ruleDescription":"Adding a new column  orderDocument.featureDescription.ppfcs.billingFeatureCodes",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_STG_FD,billingFeatureCodes,Array()"
  },
  
    {
    "ruleID":"37480001",
    "ruleType":"executeSQLQuery",
    "dataFrameID":"BMCONV_ACCOUNT_STG_BC",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"BMCONV_ACCOUNT_STG_BC",
    "ruleCategory":"TG",
 //   "debugInfo":"rows",
    "ruleText":"Select a.BLG_ACCT_TEL_NO,a.pricePlan,a.featureCode,a.featureDescription featureCodeDescription from BMCONV_ACCOUNT_STG_FD3 a,BMCONV_ACCOUNT_STG_FD3_BC b where a.BLG_ACCT_TEL_NO=b.BLG_ACCT_TEL_NO and trim(a.pricePlan)=trim(b.pricePlan) and a.featureCode != b.featureCode union (Select a.BLG_ACCT_TEL_NO,a.pricePlan,'' featureCode,'' featureCodeDescription from BMCONV_ACCOUNT_STG_FD3 a minus (Select a.BLG_ACCT_TEL_NO,a.pricePlan,'' featureCode,'' featureCodeDescription from BMCONV_ACCOUNT_STG_FD3 a,BMCONV_ACCOUNT_STG_FD3_BC b where a.BLG_ACCT_TEL_NO=b.BLG_ACCT_TEL_NO and trim(a.pricePlan)=trim(b.pricePlan) and a.featureCode != b.featureCode))"
  },
     {
    "ruleID":"37480002",
    "ruleType":"getStructColumn",
    "dataFrameID":"BMCONV_ACCOUNT_STG_BC_STRUCT",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a Structure for ppfcs",
    "ruleCategory":"TG",
//    "debugInfo":"rows",
    "ruleText":"BMCONV_ACCOUNT_STG_BC,billingFeatureCodes,featureCode,featureCodeDescription",
	"keyColumns":"BLG_ACCT_TEL_NO,pricePlan"
  },
      {
    "ruleID":"37480003",
    "ruleType":"getFrozenList",
    "dataFrameID":"BMCONV_ACCOUNT_STG_BC_ARRAY",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Generate a Array structure column billingFeatureCodes",
    "ruleCategory":"TG",
 	// //  "debugInfo":"rows",
    "ruleText":"BMCONV_ACCOUNT_STG_BC_STRUCT,billingFeatureCodes,billingFeatureCodes",
	"keyColumns":"BLG_ACCT_TEL_NO,pricePlan"
   },
    {
    "ruleID":"37480004",
    "ruleType":"joinTables",
    "dataFrameID":"BMCONV_ACCOUNT_STG_FD",
    "persist":"N",
    "ruleStatus":"off",
    "ruleDescription":"joining BMCONV_ACCOUNT_STG_FD and BMCONV_ACCOUNT_STG_BC_ARRAY",
    "ruleCategory":"TG",
    "joinType":"left",
    "renameKeys":"Y",
//  "debugInfo":"rows",
    "ruleText":"BMCONV_ACCOUNT_STG_FD,BLG_ACCT_TEL_NO,BMCONV_ACCOUNT_STG_BC_ARRAY,BLG_ACCT_TEL_NO"
  },
    {
    "ruleID":"37480004",
    "ruleType":"executeSQLQuery",
    "dataFrameID":"BMCONV_ACCOUNT_STG_FD",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"BMCONV_ACCOUNT_STG_FD",
    "ruleCategory":"TG",
    "debugInfo":"rows",
    "ruleText":"Select a.*,b.billingFeatureCodes from BMCONV_ACCOUNT_STG_FD a left join BMCONV_ACCOUNT_STG_BC_ARRAY b on  a.BLG_ACCT_TEL_NO=b.BLG_ACCT_TEL_NO and a.Priceplan=b.Priceplan"
  },
   {
    "ruleID":"37480005",
    "ruleType":"executeSQLQuery",
    "dataFrameID":"BMCONV_ACCOUNT_STG_FD",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"BMCONV_ACCOUNT_STG_FD",
    "ruleCategory":"TG",
 // "debugInfo":"rows",
    "ruleText":"Select a.* from BMCONV_ACCOUNT_STG_FD a where (BLG_ACCT_TEL_NO,Priceplan,featureCode) not in (select BLG_ACCT_TEL_NO,Priceplan, featureCode from BMCONV_ACCOUNT_STG_BC)"
  },
    {
    "ruleID":"3749",
    "ruleType":"getStructColumn",
    "dataFrameID":"BMCONV_ACCOUNT_STG_FD",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a Structure for ppfcs",
    "ruleCategory":"TG",
 // "debugInfo":"rows",
    "ruleText":"BMCONV_ACCOUNT_STG_FD,ppfc,bmProductName,productType,pricePlan,ppEffectiveDate,featureCode,isPrimary,featureDescription,action,recurTermFee,termFee,term,bundleCode,billingFeatureCodes",
	"keyColumns":"BLG_ACCT_TEL_NO"
  },
    {
    "ruleID":"3750",
    "ruleType":"getFrozenList",
    "dataFrameID":"BMCONV_ACCOUNT_STG_FD",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Generate a Array structure column ppfcs",
    "ruleCategory":"TG",
//	// //  "debugInfo":"rows",
    "ruleText":"BMCONV_ACCOUNT_STG_FD,ppfcs,ppfc",
	"keyColumns":"BLG_ACCT_TEL_NO,subMarketCode"
   },
  {
    "ruleID":"375",
    "ruleType":"getStructColumn",
    "dataFrameID":"BMCONV_ACCOUNT_STG_FD",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a Structure for orderDocument.featureDescription",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_STG_FD,featureDescription,subMarketCode,ppfcs"
  },
  {
    "ruleID":"376",
    "ruleType":"executeSQLQuery",
    "dataFrameID":"BMCONV_ACCOUNT_STG_AOGRGNGIOA",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"BMCONV_ACCOUNT_STG_AOGRGNGIOA",
    "ruleCategory":"TG",
  //  "debugInfo":"count",
    "ruleText":"select blg_acct_tel_no, orderAttributeName, concat(regexp_replace(cast(orderAttributeValue as string),' ','T'),'Z') orderAttributeValue from CDS_BMCONV_ACCOUNT_CASE2 a inner join  (select 'orderCreationDateTime' as orderAttributeName, to_utc_timestamp(current_timestamp(),'PST') as orderAttributeValue union select 'orderCompletionDateTime' as orderAttributeName, to_utc_timestamp(current_timestamp(),'PST')  as orderAttributeValue)b on 1=1 order by 1,2 desc"
  },
  {
    "ruleID":"377",
    "ruleType":"getStructColumn",
    "dataFrameID":"BMCONV_ACCOUNT_STG_AOGRGNGIOA",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a Structure for orderDocument.addlOrderAttributes.orderAttributeGroup.orderAttributeGroupName.orderAttributeGroupInfo.orderAttributes",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_STG_AOGRGNGIOA,orderAttributes,orderAttributeName,orderAttributeValue"
  },
  {
    "ruleID":"378",
    "ruleType":"getFrozenList",
    "dataFrameID":"BMCONV_ACCOUNT_STG_AOGRGNGIOA",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a Array Structure for orderAttributes",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_STG_AOGRGNGIOA,orderAttributes,orderAttributes",
    "keyColumns":"BLG_ACCT_TEL_NO"
  },
  {
    "ruleID":"379",
    "ruleType":"getStructColumn",
    "dataFrameID":"BMCONV_ACCOUNT_STG_AOGRGNGI",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a Structure for orderDocument.addlOrderAttributes.orderAttributeGroup.orderAttributeGroupName.orderAttributeGroupInfo",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_STG_AOGRGNGIOA,orderAttributeGroupInfos,orderAttributes"
  },
  {
    "ruleID":"380",
    "ruleType":"getFrozenList",
    "dataFrameID":"BMCONV_ACCOUNT_STG_AOGRGNGI",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a Structure for orderDocument.addlOrderAttributes.orderAttributeGroup.orderAttributeGroupName.orderAttributeGroupInfo",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_STG_AOGRGNGI,orderAttributeGroupInfo,orderAttributeGroupInfos",
    "keyColumns":"BLG_ACCT_TEL_NO"
  },
  {
    "ruleID":"381",
    "ruleType":"addColumns",
    "dataFrameID":"BMCONV_ACCOUNT_STG_AOGRGNGI",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Adding a new column orderDocument.addlOrderAttributes.orderAttributeGroup.orderAttributeGroupName",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_STG_AOGRGNGI,orderAttributeGroupName,'orderTransactionInfo'"
  },
  {
    "ruleID":"382",
    "ruleType":"getStructColumn",
    "dataFrameID":"BMCONV_ACCOUNT_STG_AOGR",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a Structure for orderDocument.addlOrderAttributes.orderAttributeGroup",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_STG_AOGRGNGI,orderAttributeGroups,orderAttributeGroupName,orderAttributeGroupInfo"
  },
  {
    "ruleID":"383",
    "ruleType":"getFrozenList",
    "dataFrameID":"BMCONV_ACCOUNT_STG_AOGR",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a Structure for orderDocument.addlOrderAttributes.orderAttributeGroup",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_STG_AOGR,orderAttributeGroup,orderAttributeGroups",
    "keyColumns":"BLG_ACCT_TEL_NO"
  },
    {
    "ruleID":"3760",
    "ruleType":"executeSQLQuery",
    "dataFrameID":"BMCONV_ACCOUNT_STG_AOGRGNGIOA_1",
    "persist":"N",
    "ruleStatus":"off",
    "ruleDescription":"BMCONV_ACCOUNT_STG_AOGRGNGIOA_1",
    "ruleCategory":"TG",
	// "debugInfo":"rows",
    "ruleText":"select BLG_ACCT_TEL_NO, orderAttributeName, orderAttributeValue from Martens_Value"
  },
   {
    "ruleID":"3770",
    "ruleType":"getStructColumn",
    "dataFrameID":"BMCONV_ACCOUNT_STG_AOGRGNGIOA_1",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a Structure for orderDocument.addlOrderAttributes.orderAttributeGroup.orderAttributeGroupName.orderAttributeGroupInfo.orderAttributes",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_STG_AOGRGNGIOA_1,orderAttributes,orderAttributeName,orderAttributeValue"
  },
  {
    "ruleID":"3780",
    "ruleType":"getFrozenList",
    "dataFrameID":"BMCONV_ACCOUNT_STG_AOGRGNGIOA_1",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a Array Structure for orderAttributes",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_STG_AOGRGNGIOA_1,orderAttributes,orderAttributes",
    "keyColumns":"BLG_ACCT_TEL_NO"
  },
  {
    "ruleID":"3790",
    "ruleType":"getStructColumn",
    "dataFrameID":"BMCONV_ACCOUNT_STG_AOGRGNGI_1",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a Structure for orderDocument.addlOrderAttributes.orderAttributeGroup.orderAttributeGroupName.orderAttributeGroupInfo",
    "ruleCategory":"TG",
	//  "debugInfo":"rows",
    "ruleText":"BMCONV_ACCOUNT_STG_AOGRGNGIOA_1,orderAttributeGroupInfos,orderAttributes"
  },
  {
    "ruleID":"3800",
    "ruleType":"getFrozenList",
    "dataFrameID":"BMCONV_ACCOUNT_STG_AOGRGNGI_1",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a Structure for orderDocument.addlOrderAttributes.orderAttributeGroup.orderAttributeGroupName.orderAttributeGroupInfo",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_STG_AOGRGNGI_1,orderAttributeGroupInfo,orderAttributeGroupInfos",
    "keyColumns":"BLG_ACCT_TEL_NO"
  },
  {
    "ruleID":"3810",
    "ruleType":"addColumns",
    "dataFrameID":"BMCONV_ACCOUNT_STG_AOGRGNGI_1",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Adding a new column orderDocument.addlOrderAttributes.orderAttributeGroup.orderAttributeGroupName",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_STG_AOGRGNGI_1,orderAttributeGroupName,'addressType'"
  },
  {
    "ruleID":"3820",
    "ruleType":"getStructColumn",
    "dataFrameID":"BMCONV_ACCOUNT_STG_AOGR_1",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a Structure for orderDocument.addlOrderAttributes.orderAttributeGroup",
    "ruleCategory":"TG",
	//  "debugInfo":"rows",
    "ruleText":"BMCONV_ACCOUNT_STG_AOGRGNGI_1,orderAttributeGroups,orderAttributeGroupName,orderAttributeGroupInfo"
  },
    {
    "ruleID":"37601",
    "ruleType":"executeSQLQuery",
    "dataFrameID":"BMCONV_ACCOUNT_STG_AOGRGNGIOA_ENS",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"BMCONV_ACCOUNT_STG_AOGRGNGIOA_ENS",
    "ruleCategory":"TG",
	// //  "debugInfo":"rows",
    "ruleText":"select blg_acct_tel_no, orderAttributeName, orderAttributeValue from CDS_BMCONV_ACCOUNT_CASE2 a inner join  (select 'conversionIndicator' as orderAttributeName, 'ENSEMBLE' as orderAttributeValue)b on 1=1 order by 1,2 desc"
  },
   {
    "ruleID":"37701",
    "ruleType":"getStructColumn",
    "dataFrameID":"BMCONV_ACCOUNT_STG_AOGRGNGIOA_ENS",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a Structure for orderDocument.addlOrderAttributes.orderAttributeGroup.orderAttributeGroupName.orderAttributeGroupInfo.orderAttributes",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_STG_AOGRGNGIOA_ENS,orderAttributes,orderAttributeName,orderAttributeValue"
  },
  {
    "ruleID":"37801",
    "ruleType":"getFrozenList",
    "dataFrameID":"BMCONV_ACCOUNT_STG_AOGRGNGIOA_ENS",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a Array Structure for orderAttributes",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_STG_AOGRGNGIOA_ENS,orderAttributes,orderAttributes",
    "keyColumns":"BLG_ACCT_TEL_NO"
  },
  {
    "ruleID":"37901",
    "ruleType":"getStructColumn",
    "dataFrameID":"BMCONV_ACCOUNT_STG_AOGRGNGI_ENS",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a Structure for orderDocument.addlOrderAttributes.orderAttributeGroup.orderAttributeGroupName.orderAttributeGroupInfo",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_STG_AOGRGNGIOA_ENS,orderAttributeGroupInfos,orderAttributes"
  },
  {
    "ruleID":"38001",
    "ruleType":"getFrozenList",
    "dataFrameID":"BMCONV_ACCOUNT_STG_AOGRGNGI_ENS",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a Structure for orderDocument.addlOrderAttributes.orderAttributeGroup.orderAttributeGroupName.orderAttributeGroupInfo",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_STG_AOGRGNGI_ENS,orderAttributeGroupInfo,orderAttributeGroupInfos",
    "keyColumns":"BLG_ACCT_TEL_NO"
  },
  {
    "ruleID":"38101",
    "ruleType":"addColumns",
    "dataFrameID":"BMCONV_ACCOUNT_STG_AOGRGNGI_ENS",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Adding a new column orderDocument.addlOrderAttributes.orderAttributeGroup.orderAttributeGroupName",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_STG_AOGRGNGI_ENS,orderAttributeGroupName,'conversionIndicator'"
  },
  {
    "ruleID":"38201",
    "ruleType":"getStructColumn",
    "dataFrameID":"BMCONV_ACCOUNT_STG_AOGR_ENS",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a Structure for orderDocument.addlOrderAttributes.orderAttributeGroup",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_STG_AOGRGNGI_ENS,orderAttributeGroups,orderAttributeGroupName,orderAttributeGroupInfo"
  },
{
    "ruleID":"383001",
    "ruleType":"unionTables",
    "dataFrameID":"BMCONV_ACCOUNT_STG_AOGR_1",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Union for BMCONV_ACCOUNT_STG_AOGR_1",
    "ruleCategory":"TG",
 	// //  "debugInfo":"rows",
    "ruleText":"BMCONV_ACCOUNT_STG_AOGR_1,BMCONV_ACCOUNT_STG_AOGR_ENS"
  },
  {
    "ruleID":"3830",
    "ruleType":"getFrozenList",
    "dataFrameID":"BMCONV_ACCOUNT_STG_AOGR_1",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a Structure for orderDocument.addlOrderAttributes.orderAttributeGroup",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_STG_AOGR_1,orderAttributeGroup,orderAttributeGroups",
    "keyColumns":"BLG_ACCT_TEL_NO"
  },
   {
    "ruleID":"38300",
    "ruleType":"unionTables",
    "dataFrameID":"BMCONV_ACCOUNT_STG_AOGR_11",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Union for BMCONV_ACCOUNT_STG_AOGR_11",
    "ruleCategory":"TG",
 //   "debugInfo":"count",
    "ruleText":"BMCONV_ACCOUNT_STG_AOGR,BMCONV_ACCOUNT_STG_AOGR_1"
  },
  {
    "ruleID":"384",
    "ruleType":"getStructColumn",
    "dataFrameID":"BMCONV_ACCOUNT_STG_AO",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a Structure for addlOrderAttribute",
    "ruleCategory":"TG",
	//  "debugInfo":"rows",
    "ruleText":"BMCONV_ACCOUNT_STG_AOGR_11,addlOrderAttribute,orderAttributeGroup"
  },
  {
    "ruleID":"385",
    "ruleType":"getFrozenList",
    "dataFrameID":"BMCONV_ACCOUNT_STG_AO",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a Array for orderDocument.addlOrderAttributes",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACCOUNT_STG_AO,addlOrderAttributes,addlOrderAttribute",
    "keyColumns":"BLG_ACCT_TEL_NO"
  },
  {
    "ruleID":"386",
    "ruleType":"joinTables",
    "dataFrameID":"BMCONV_ACCOUNT_FIDS_STG_AI_A_R",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Joining BMCONV_ACCOUNT_FIDS_STG_AIJOIN and BMCONV_ACCOUNT_STG_23_JOIN ",
    "ruleCategory":"TG",
    "joinType":"inner",
    "renameKeys":"Y",
 //   "debugInfo":"count",
    "ruleText":"BMCONV_ACCOUNT_FIDS_STG_AIJOIN,BLG_ACCT_TEL_NO,BMCONV_ACCOUNT_STG_23_JOIN,BLG_ACCT_TEL_NO"
  },
  {
    "ruleID":"387",
    "ruleType":"joinTables",
    "dataFrameID":"BMCONV_ACCOUNT_STG_ARAICR",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Joining BMCONV_ACCOUNT_FIDS_STG_AI_A_R and BMCONV_ACCOUNT_STG_CRCIDIBE ",
    "ruleCategory":"TG",
    "joinType":"inner",
    "renameKeys":"Y",
     //  "debugInfo":"rows",
    "ruleText":"BMCONV_ACCOUNT_FIDS_STG_AI_A_R,BLG_ACCT_TEL_NO,BMCONV_ACCOUNT_STG_CRCIDIBE,BLG_ACCT_TEL_NO"
  },
  {
    "ruleID":"388",
    "ruleType":"joinTables",
    "dataFrameID":"BMCONV_ACCOUNT_STG_ARAICRSC",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Joining BMCONV_ACCOUNT_STG_ARAICR and BMCONV_ACCOUNT_STG_SCDTSH",
    "ruleCategory":"TG",
    "joinType":"inner",
    "renameKeys":"Y",
     //  "debugInfo":"rows",
    "ruleText":"BMCONV_ACCOUNT_STG_ARAICR,BLG_ACCT_TEL_NO,BMCONV_ACCOUNT_STG_SCDTSH,BLG_ACCT_TEL_NO"
  },
  {
    "ruleID":"389",
    "ruleType":"joinTables",
    "dataFrameID":"BMCONV_ACCOUNT_STG_ARAICRSCAD",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Joining BMCONV_ACCOUNT_STG_ARAICRSC and BMCONV_ACCOUNT_STG_AD",
    "ruleCategory":"TG",
    "joinType":"inner",
    "renameKeys":"Y",
	 //  "debugInfo":"rows",
    "ruleText":"BMCONV_ACCOUNT_STG_ARAICRSC,BLG_ACCT_TEL_NO,BMCONV_ACCOUNT_STG_AD,BLG_ACCT_TEL_NO"
  },
  {
    "ruleID":"390",
    "ruleType":"joinTables",
    "dataFrameID":"BMCONV_ACC_STG_ARAICRSCADFD",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"joining BMCONV_ACCOUNT_STG_ARAICRSCAD and BMCONV_ACCOUNT_STG_FD",
    "ruleCategory":"TG",
    "joinType":"inner",
    "renameKeys":"Y",
	 //  "debugInfo":"rows",
    "ruleText":"BMCONV_ACCOUNT_STG_ARAICRSCAD,BLG_ACCT_TEL_NO,BMCONV_ACCOUNT_STG_FD,BLG_ACCT_TEL_NO"
  },
  {
    "ruleID":"391",
    "ruleType":"addColumns",
    "dataFrameID":"BMCONV_ACC_STG_ARAICRSCADFD",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Adding a new column  orderDocument.isFinalBillAddressChanged",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACC_STG_ARAICRSCADFD,isFinalBillAddressChanged,false"
  },
  {
    "ruleID":"392",
    "ruleType":"addColumns",
    "dataFrameID":"BMCONV_ACC_STG_ARAICRSCADFD",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Adding a new column  orderDocument.returnEquipments",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACC_STG_ARAICRSCADFD,returnEquipments,array()"
  },
  {
    "ruleID":"393",
    "ruleType":"addColumns",
    "dataFrameID":"BMCONV_ACC_STG_ARAICRSCADFD",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Adding a new column  orderDocument.existingTN",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACC_STG_ARAICRSCADFD,existingTN,array()"
  },
  {
    "ruleID":"394",
    "ruleType":"joinTables",
    "dataFrameID":"BMCONV_ACC_STG_ARAICRSCADFDAO",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"joining BMCONV_ACC_STG_ARAICRSCADFD and BMCONV_ACCOUNT_STG_AO",
    "ruleCategory":"TG",
    "joinType":"inner",
    "renameKeys":"Y",
//	"debugInfo":"count",
    "ruleText":"BMCONV_ACC_STG_ARAICRSCADFD,BLG_ACCT_TEL_NO,BMCONV_ACCOUNT_STG_AO,BLG_ACCT_TEL_NO"
  },
  {
    "ruleID":"4000",
    "ruleType":"dropColumns",
    "dataFrameID":"BMCONV_ACC_STG_ARAICRSCADFDAO",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Removing the columns",
    "ruleCategory":"TG",
    "ruleText":"BMCONV_ACC_STG_ARAICRSCADFDAO,BAN"
  },
  {
    "ruleID":"401",
    "ruleType":"joinTables",
    "dataFrameID":"PP_OM_COLLECTION_MAPPING",
    "persist":"Y",
    "ruleStatus":"on",
    "ruleDescription":"Joining 2 Staging Tables",
    "ruleCategory":"TG",
    "joinType":"inner",
    "renameKeys":"Y",
    "debugInfo":"count",
    "ruleText":"CDS_BMCONV_ACCOUNT_CASE2,BLG_ACCT_TEL_NO,BMCONV_ACC_STG_ARAICRSCADFDAO,BLG_ACCT_TEL_NO"
  },
  {
    "ruleID":"402",
    "ruleType":"getStructColumn",
    "dataFrameID":"PP_OM_COLLECTION_MAPPING",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Define a Structure for Order Document",
    "ruleCategory":"TG",
 // "debugInfo":"rows",
    "ruleText":"PP_OM_COLLECTION_MAPPING,orderDocument,serviceAddress,accountInfo,availableServices,customerOrderItems,reservedTN,existingServiceAddress,productConfiguration,existingProductConfiguration,creditReview,schedule,additionalInfo,featureDescription,isFinalBillAddressChanged,returnEquipments,existingTN,addlOrderAttributes"
  },
  {
    "ruleID":"4030",
    "ruleType":"dropColumns",
    "dataFrameID":"PP_OM_COLLECTION_MAPPING",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Removing the columns",
    "ruleCategory":"TG",
//	// //  "debugInfo":"rows",
    "ruleText":"PP_OM_COLLECTION_MAPPING,BANN,STREETADDRESS,ZIP,STREETADDRESS,STATEORPROVINCE,CITY,UNIT,CITYNAME,STATE,ADDRESS_ID,POSTALADDRESSFLAG,ADDRESSLINE,UNITNUMBER,COUNTRY,requestField"
  },
    {
    "ruleID":"4040",
    "ruleType":"executeSQLQuery",
    "dataFrameID":"PP_OM_COLLECTION_MAPPING",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"To Get the offerName and offerId",
    "ruleCategory":"TG",
    "debugInfo":"count",
    "ruleText":"select * from PP_OM_COLLECTION_MAPPING where orderDocument.customerOrderItems.offerName[0]!='' and size(orderDocument.customerOrderItems.offerName) ==1 "
  },
     {
      "ruleID":"481",
      "ruleType":"executeSQLQuery",
      "dataFrameID":"COMMON_ACCOUNTS",
      "ruleText":"select ban from(select ban from PP_OM_COLLECTION_MAPPING inner join (select ban from CDS_BMCONV_ACCOUNT_CASE1) aa using(ban))",
      "ruleDescription":"Identify valid Bans",
      "ruleCategory":"TG",
      "persist":"N",
//	  "debugInfo":"count",
      "ruleStatus":"on"
   },
    {
    "ruleID":"405",
    "ruleType":"loadJSON",
    "dataFrameID":"COMMON_ACCOUNTS",
    "persist":"N",
    "ruleStatus":"on",
    "saveMode":"overwrite",
    "ruleCategory":"LG",
    "ruleDescription":"Save result in JSON format",
    "ruleText":"/user/udmf_ctl/target/data/Converted_BANS"
    },
	
    {
      "ruleID":"482",
      "ruleType":"joinTables",
      "dataFrameID":"INVALID_ACCOUNTS",
      "persist":"N",
      "ruleDescription":"Identify unprocessed Ban numbers",
      "ruleStatus":"on",
      "ruleCategory":"TG",
      "joinType":"leftanti",
      "renameKeys":"Y",
      "ruleText":"CDS_BMCONV_ACCOUNT,ban,COMMON_ACCOUNTS,ban"
   },
   {
    "ruleID":"405",
    "ruleType":"loadJSON",
    "dataFrameID":"INVALID_ACCOUNTS",
    "persist":"N",
    "ruleStatus":"on",
    "saveMode":"overwrite",
    "ruleCategory":"LG",
    "ruleDescription":"Save result in JSON format",
    "ruleText":"/user/udmf_ctl/target/data/Failed_BANS"
    },
   {
    "ruleID":"406",
    "ruleType":"loadJSON",
    "dataFrameID":"PP_OM_COLLECTION_MAPPING",
    "persist":"N",
    "ruleStatus":"on",
    "saveMode":"overwrite",
    "ruleCategory":"LG",
    "ruleDescription":"Save result in JSON format",
    "ruleText":"/user/udmf_ctl/target/data/PP_OM_COLLECTION_MAPPING"
    },
	{
    "ruleID":"4031",
    "ruleType":"dropColumns",
    "dataFrameID":"PP_OM_COLLECTION_MAPPING",
    "persist":"N",
    "ruleStatus":"on",
    "ruleDescription":"Removing the columns",
    "ruleCategory":"TG",
    "ruleText":"PP_OM_COLLECTION_MAPPING,BAN,BLG_ACCT_TEL_NO,STREETADDRESS,ZIP,STREETADDRESS,STATEORPROVINCE,CITY"
  },
    {
    "ruleID":"4050",
    "ruleType":"loadJSON",
    "dataFrameID":"PP_OM_COLLECTION_MAPPING",
    "persist":"N",
    "ruleStatus":"on",
    "saveMode":"overwrite",
    "ruleCategory":"LG",
    "ruleDescription":"Save result in JSON format",
    "ruleText":"/user/udmf_ctl/target/data/NO_BAN_PP_OM_COLLECTION_MAPPING"
    }
]
